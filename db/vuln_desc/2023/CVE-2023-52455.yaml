configurations:
- nodes:
  - cpeMatch:
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 723F5211-5C37-4F95-A4D3-FA6C2E6F914C
      versionEndExcluding: 6.6.14
      versionStartIncluding: 6.3.0
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 0EA3778C-730B-464C-8023-18CA6AC0B807
      versionEndExcluding: 6.7.2
      versionStartIncluding: 6.7.0
      vulnerable: true
    negate: false
    operator: OR
cveTags: []
descriptions:
- lang: en
  value: 'In the Linux kernel, the following vulnerability has been resolved:


    iommu: Don''t reserve 0-length IOVA region


    When the bootloader/firmware doesn''t setup the framebuffers, their

    address and size are 0 in "iommu-addresses" property. If IOVA region is

    reserved with 0 length, then it ends up corrupting the IOVA rbtree with

    an entry which has pfn_hi < pfn_lo.

    If we intend to use display driver in kernel without framebuffer then

    it''s causing the display IOMMU mappings to fail as entire valid IOVA

    space is reserved when address and length are passed as 0.

    An ideal solution would be firmware removing the "iommu-addresses"

    property and corresponding "memory-region" if display is not present.

    But the kernel should be able to handle this by checking for size of

    IOVA region and skipping the IOVA reservation if size is 0. Also, add

    a warning if firmware is requesting 0-length IOVA region reservation.'
- lang: es
  value: "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: iommu:\
    \ no reservar regi\xF3n IOVA de longitud 0 Cuando el gestor de arranque/firmware\
    \ no configura los framebuffers, su direcci\xF3n y tama\xF1o son 0 en la propiedad\
    \ \"iommu-addresses\". Si la regi\xF3n IOVA est\xE1 reservada con una longitud\
    \ de 0, termina corrompiendo el rbtree de IOVA con una entrada que tiene pfn_hi\
    \ &lt; pfn_lo. Si pretendemos utilizar el controlador de pantalla en el kernel\
    \ sin framebuffer, entonces las asignaciones IOMMU de pantalla fallar\xE1n ya\
    \ que se reserva todo el espacio IOVA v\xE1lido cuando la direcci\xF3n y la longitud\
    \ se pasan como 0. Una soluci\xF3n ideal ser\xEDa que el firmware elimine la propiedad\
    \ \"iommu-addresses\". y la \"regi\xF3n de memoria\" correspondiente si la pantalla\
    \ no est\xE1 presente. Pero el kernel deber\xEDa poder manejar esto verificando\
    \ el tama\xF1o de la regi\xF3n IOVA y omitiendo la reserva de IOVA si el tama\xF1\
    o es 0. Adem\xE1s, agregue una advertencia si el firmware solicita una reserva\
    \ de regi\xF3n IOVA de longitud 0."
id: CVE-2023-52455
lastModified: '2024-04-30T19:34:34.080'
metrics:
  cvssMetricV31:
  - cvssData:
      attackComplexity: LOW
      attackVector: LOCAL
      availabilityImpact: HIGH
      baseScore: 7.8
      baseSeverity: HIGH
      confidentialityImpact: HIGH
      integrityImpact: HIGH
      privilegesRequired: LOW
      scope: UNCHANGED
      userInteraction: NONE
      vectorString: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
      version: '3.1'
    exploitabilityScore: 1.8
    impactScore: 5.9
    source: nvd@nist.gov
    type: Primary
published: '2024-02-23T15:15:08.193'
references:
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/5e23e283910c9f30248732ae0770bcb0c9438abf
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/98b8a550da83cc392a14298c4b3eaaf0332ae6ad
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/bb57f6705960bebeb832142ce9abf43220c3eab1
sourceIdentifier: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
vulnStatus: Analyzed
weaknesses:
- description:
  - lang: en
    value: NVD-CWE-noinfo
  source: nvd@nist.gov
  type: Primary
