descriptions:
- lang: en
  value: 'In the Linux kernel, the following vulnerability has been resolved:


    fs: Pass AT_GETATTR_NOSEC flag to getattr interface function


    When vfs_getattr_nosec() calls a filesystem''s getattr interface function

    then the ''nosec'' should propagate into this function so that

    vfs_getattr_nosec() can again be called from the filesystem''s gettattr

    rather than vfs_getattr(). The latter would add unnecessary security

    checks that the initial vfs_getattr_nosec() call wanted to avoid.

    Therefore, introduce the getattr flag GETATTR_NOSEC and allow to pass

    with the new getattr_flags parameter to the getattr interface function.

    In overlayfs and ecryptfs use this flag to determine which one of the

    two functions to call.


    In a recent code change introduced to IMA vfs_getattr_nosec() ended up

    calling vfs_getattr() in overlayfs, which in turn called

    security_inode_getattr() on an exiting process that did not have

    current->fs set anymore, which then caused a kernel NULL pointer

    dereference. With this change the call to security_inode_getattr() can

    be avoided, thus avoiding the NULL pointer dereference.'
- lang: es
  value: "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: fs: pasar\
    \ el indicador AT_GETATTR_NOSEC a la funci\xF3n de interfaz getattr. Cuando vfs_getattr_nosec()\
    \ llama a la funci\xF3n de interfaz getattr de un sistema de archivos, entonces\
    \ 'nosec' debe propagarse a esta funci\xF3n para que se pueda volver a llamar\
    \ a vfs_getattr_nosec() desde gettattr del sistema de archivos en lugar de vfs_getattr().\
    \ Esto \xFAltimo agregar\xEDa controles de seguridad innecesarios que la llamada\
    \ inicial a vfs_getattr_nosec() quer\xEDa evitar. Por lo tanto, introduzca el\
    \ indicador getattr GETATTR_NOSEC y permita pasar con el nuevo par\xE1metro getattr_flags\
    \ a la funci\xF3n de interfaz getattr. En overlayfs y ecryptfs use este indicador\
    \ para determinar cu\xE1l de las dos funciones llamar. En un cambio de c\xF3digo\
    \ reciente introducido en IMA, vfs_getattr_nosec() termin\xF3 llamando a vfs_getattr()\
    \ en overlayfs, que a su vez llam\xF3 a security_inode_getattr() en un proceso\
    \ saliente que ya no ten\xEDa current-&gt;fs configurado, lo que luego provoc\xF3\
    \ una desreferencia del puntero NULL del kernel . Con este cambio se puede evitar\
    \ la llamada a security_inode_getattr(), evitando as\xED la desreferencia del\
    \ puntero NULL."
id: CVE-2023-52779
lastModified: '2024-05-21T16:53:56.550'
metrics: {}
published: '2024-05-21T16:15:16.890'
references:
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/3fb0fa08641903304b9d81d52a379ff031dc41d4
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/8a924db2d7b5eb69ba08b1a0af46e9f1359a9bdf
sourceIdentifier: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
vulnStatus: Awaiting Analysis
