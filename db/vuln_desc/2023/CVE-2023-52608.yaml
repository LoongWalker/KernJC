cveTags: []
descriptions:
- lang: en
  value: 'In the Linux kernel, the following vulnerability has been resolved:


    firmware: arm_scmi: Check mailbox/SMT channel for consistency


    On reception of a completion interrupt the shared memory area is accessed

    to retrieve the message header at first and then, if the message sequence

    number identifies a transaction which is still pending, the related

    payload is fetched too.


    When an SCMI command times out the channel ownership remains with the

    platform until eventually a late reply is received and, as a consequence,

    any further transmission attempt remains pending, waiting for the channel

    to be relinquished by the platform.


    Once that late reply is received the channel ownership is given back

    to the agent and any pending request is then allowed to proceed and

    overwrite the SMT area of the just delivered late reply; then the wait

    for the reply to the new request starts.


    It has been observed that the spurious IRQ related to the late reply can

    be wrongly associated with the freshly enqueued request: when that happens

    the SCMI stack in-flight lookup procedure is fooled by the fact that the

    message header now present in the SMT area is related to the new pending

    transaction, even though the real reply has still to arrive.


    This race-condition on the A2P channel can be detected by looking at the

    channel status bits: a genuine reply from the platform will have set the

    channel free bit before triggering the completion IRQ.


    Add a consistency check to validate such condition in the A2P ISR.'
- lang: es
  value: "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: firmware:\
    \ arm_scmi: comprueba la coherencia del buz\xF3n/canal SMT Al recibir una interrupci\xF3\
    n de finalizaci\xF3n, se accede al \xE1rea de memoria compartida para recuperar\
    \ el encabezado del mensaje al principio y luego, si el n\xFAmero de secuencia\
    \ del mensaje identifica una transacci\xF3n que a\xFAn est\xE1 pendiente, el payload\
    \ relacionado tambi\xE9n se recupera. Cuando se agota el tiempo de espera de un\
    \ comando SCMI, la propiedad del canal permanece en la plataforma hasta que finalmente\
    \ se recibe una respuesta tard\xEDa y, como consecuencia, cualquier intento de\
    \ transmisi\xF3n adicional permanece pendiente, esperando que la plataforma abandone\
    \ el canal. Una vez que se recibe esa respuesta tard\xEDa, la propiedad del canal\
    \ se devuelve al agente y cualquier solicitud pendiente puede continuar y sobrescribir\
    \ el \xE1rea SMT de la respuesta tard\xEDa reci\xE9n entregada; luego comienza\
    \ la espera de la respuesta a la nueva solicitud. Se ha observado que la IRQ espuria\
    \ relacionada con la respuesta tard\xEDa puede asociarse err\xF3neamente con la\
    \ solicitud reci\xE9n puesta en cola: cuando eso sucede, el procedimiento de b\xFA\
    squeda en curso de la pila SCMI se ve enga\xF1ado por el hecho de que el encabezado\
    \ del mensaje ahora presente en el \xE1rea SMT es relacionado con la nueva transacci\xF3\
    n pendiente, aunque la respuesta real a\xFAn no ha llegado. Esta condici\xF3n\
    \ de ejecuci\xF3n en el canal A2P se puede detectar observando los bits de estado\
    \ del canal: una respuesta genuina de la plataforma habr\xE1 configurado el bit\
    \ libre del canal antes de activar la IRQ de finalizaci\xF3n. Agregue una verificaci\xF3\
    n de coherencia para validar dicha condici\xF3n en el ISR A2P."
id: CVE-2023-52608
lastModified: '2024-03-13T14:28:45.217'
metrics: {}
published: '2024-03-13T14:15:07.240'
references:
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/12dc4217f16551d6dee9cbefc23fdb5659558cda
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/437a310b22244d4e0b78665c3042e5d1c0f45306
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/614cc65032dcb0b64d23f5c5e338a8a04b12be5d
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/7f95f6997f4fdd17abec3200cae45420a5489350
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/9b5e1b93c83ee5fc9f5d7bd2d45b421bd87774a2
sourceIdentifier: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
vulnStatus: Awaiting Analysis
