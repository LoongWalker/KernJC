cveTags: []
descriptions:
- lang: en
  value: 'In the Linux kernel, the following vulnerability has been resolved:


    ring-buffer: Do not attempt to read past "commit"


    When iterating over the ring buffer while the ring buffer is active, the

    writer can corrupt the reader. There''s barriers to help detect this and

    handle it, but that code missed the case where the last event was at the

    very end of the page and has only 4 bytes left.


    The checks to detect the corruption by the writer to reads needs to see the

    length of the event. If the length in the first 4 bytes is zero then the

    length is stored in the second 4 bytes. But if the writer is in the process

    of updating that code, there''s a small window where the length in the first

    4 bytes could be zero even though the length is only 4 bytes. That will

    cause rb_event_length() to read the next 4 bytes which could happen to be off
    the

    allocated page.


    To protect against this, fail immediately if the next event pointer is

    less than 8 bytes from the end of the commit (last byte of data), as all

    events must be a minimum of 8 bytes anyway.'
- lang: es
  value: "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: ring-buffer:\
    \ no intente leer m\xE1s all\xE1 del \"commit\" Al iterar sobre el b\xFAfer de\
    \ anillo mientras el b\xFAfer de anillo est\xE1 activo, el escritor puede da\xF1\
    ar al lector. Existen barreras para ayudar a detectar esto y manejarlo, pero ese\
    \ c\xF3digo omiti\xF3 el caso en el que el \xFAltimo evento estaba al final de\
    \ la p\xE1gina y solo le quedan 4 bytes. Las comprobaciones para detectar la corrupci\xF3\
    n por parte del escritor en las lecturas deben ver la duraci\xF3n del evento.\
    \ Si la longitud de los primeros 4 bytes es cero, entonces la longitud se almacena\
    \ en los segundos 4 bytes. Pero si el escritor est\xE1 en el proceso de actualizar\
    \ ese c\xF3digo, hay una peque\xF1a ventana donde la longitud de los primeros\
    \ 4 bytes podr\xEDa ser cero aunque la longitud sea solo de 4 bytes. Eso har\xE1\
    \ que rb_event_length() lea los siguientes 4 bytes que podr\xEDan estar fuera\
    \ de la p\xE1gina asignada. Para protegerse contra esto, falle inmediatamente\
    \ si el siguiente puntero de evento est\xE1 a menos de 8 bytes del final de el\
    \ commit (\xFAltimo byte de datos), ya que todos los eventos deben tener un m\xED\
    nimo de 8 bytes de todos modos."
id: CVE-2023-52501
lastModified: '2024-03-04T13:58:23.447'
metrics: {}
published: '2024-03-02T22:15:47.153'
references:
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/344f2f3e61a90f0150c754796ec9a17fcaeec03d
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/75fc9e99b3a71006720ad1e029db11a4b5c32d4a
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/95a404bd60af6c4d9d8db01ad14fe8957ece31ca
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/b08a4938229dbb530a35c41b83002a1457c6ff49
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/cee5151c5410e868826b8afecfb356f3799ebea3
sourceIdentifier: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
vulnStatus: Awaiting Analysis
