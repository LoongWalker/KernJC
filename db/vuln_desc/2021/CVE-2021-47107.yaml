descriptions:
- lang: en
  value: 'In the Linux kernel, the following vulnerability has been resolved:


    NFSD: Fix READDIR buffer overflow


    If a client sends a READDIR count argument that is too small (say,

    zero), then the buffer size calculation in the new init_dirlist

    helper functions results in an underflow, allowing the XDR stream

    functions to write beyond the actual buffer.


    This calculation has always been suspect. NFSD has never sanity-

    checked the READDIR count argument, but the old entry encoders

    managed the problem correctly.


    With the commits below, entry encoding changed, exposing the

    underflow to the pointer arithmetic in xdr_reserve_space().


    Modern NFS clients attempt to retrieve as much data as possible

    for each READDIR request. Also, we have no unit tests that

    exercise the behavior of READDIR at the lower bound of @count

    values. Thus this case was missed during testing.'
- lang: es
  value: "En el kernel de Linux, se resolvi\xF3 la siguiente vulnerabilidad: NFSD:\
    \ corrige el desbordamiento del b\xFAfer READDIR Si un cliente env\xEDa un argumento\
    \ de recuento READDIR que es demasiado peque\xF1o (digamos, cero), entonces el\
    \ c\xE1lculo del tama\xF1o del b\xFAfer en las nuevas funciones auxiliares init_dirlist\
    \ da como resultado un subdesbordamiento, lo que permite que las funciones de\
    \ flujo XDR escriban m\xE1s all\xE1 del b\xFAfer real. Este c\xE1lculo siempre\
    \ ha sido sospechoso. NFSD nunca ha verificado la cordura del argumento de conteo\
    \ READDIR, pero los codificadores de entrada antiguos manejaron el problema correctamente.\
    \ Con las confirmaciones a continuaci\xF3n, la codificaci\xF3n de entrada cambi\xF3\
    , exponiendo el desbordamiento a la aritm\xE9tica del puntero en xdr_reserve_space().\
    \ Los clientes NFS modernos intentan recuperar la mayor cantidad de datos posible\
    \ para cada solicitud READDIR. Adem\xE1s, no tenemos pruebas unitarias que ejerzan\
    \ el comportamiento de READDIR en el l\xEDmite inferior de los valores @count.\
    \ Por lo tanto, este caso se pas\xF3 por alto durante las pruebas."
id: CVE-2021-47107
lastModified: '2024-03-05T13:41:01.900'
metrics: {}
published: '2024-03-04T19:15:18.793'
references:
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/53b1119a6e5028b125f431a0116ba73510d82a72
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/eabc0aab98e5218ceecd82069b0d6fdfff5ee885
sourceIdentifier: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
vulnStatus: Awaiting Analysis
