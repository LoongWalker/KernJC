descriptions:
- lang: en
  value: 'In the Linux kernel, the following vulnerability has been resolved:


    perf/core: Fix unconditional security_locked_down() call


    Currently, the lockdown state is queried unconditionally, even though

    its result is used only if the PERF_SAMPLE_REGS_INTR bit is set in

    attr.sample_type. While that doesn''t matter in case of the Lockdown LSM,

    it causes trouble with the SELinux''s lockdown hook implementation.


    SELinux implements the locked_down hook with a check whether the current

    task''s type has the corresponding "lockdown" class permission

    ("integrity" or "confidentiality") allowed in the policy. This means

    that calling the hook when the access control decision would be ignored

    generates a bogus permission check and audit record.


    Fix this by checking sample_type first and only calling the hook when

    its result would be honored.'
- lang: es
  value: "En el kernel de Linux, se resolvi\xF3 la siguiente vulnerabilidad: perf/core:\
    \ corrige la llamada incondicional a security_locked_down() Actualmente, el estado\
    \ de bloqueo se consulta incondicionalmente, aunque su resultado se usa solo si\
    \ el bit PERF_SAMPLE_REGS_INTR est\xE1 establecido en attr.sample_type. Si bien\
    \ eso no importa en el caso del Lockdown LSM, causa problemas con la implementaci\xF3\
    n del gancho de bloqueo de SELinux. SELinux implementa el gancho lock_down comprobando\
    \ si el tipo de tarea actual tiene el correspondiente permiso de clase de \"bloqueo\"\
    \ (\"integridad\" o \"confidencialidad\") permitido en la pol\xEDtica. Esto significa\
    \ que llamar al enlace cuando se ignorar\xEDa la decisi\xF3n de control de acceso\
    \ genera una verificaci\xF3n de permisos y un registro de auditor\xEDa falsos.\
    \ Solucione este problema verificando sample_type primero y solo llamando al gancho\
    \ cuando se respete su resultado."
id: CVE-2021-46971
lastModified: '2024-02-28T14:06:45.783'
metrics: {}
published: '2024-02-27T19:04:07.343'
references:
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/08ef1af4de5fe7de9c6d69f1e22e51b66e385d9b
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/4348d3b5027bc3ff6336368b6c60605d4ef8e1ce
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/b246759284d6a2bc5b6f1009caeeb3abce2ec9ff
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/c7b0208ee370b89d20486fae71cd9abb759819c1
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/f5809ca4c311b71bfaba6d13f4e39eab0557895e
sourceIdentifier: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
vulnStatus: Awaiting Analysis
