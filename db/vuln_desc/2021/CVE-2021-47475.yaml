descriptions:
- lang: en
  value: 'In the Linux kernel, the following vulnerability has been resolved:


    comedi: vmk80xx: fix transfer-buffer overflows


    The driver uses endpoint-sized USB transfer buffers but up until

    recently had no sanity checks on the sizes.


    Commit e1f13c879a7c ("staging: comedi: check validity of wMaxPacketSize

    of usb endpoints found") inadvertently fixed NULL-pointer dereferences

    when accessing the transfer buffers in case a malicious device has a

    zero wMaxPacketSize.


    Make sure to allocate buffers large enough to handle also the other

    accesses that are done without a size check (e.g. byte 18 in

    vmk80xx_cnt_insn_read() for the VMK8061_MODEL) to avoid writing beyond

    the buffers, for example, when doing descriptor fuzzing.


    The original driver was for a low-speed device with 8-byte buffers.

    Support was later added for a device that uses bulk transfers and is

    presumably a full-speed device with a maximum 64-byte wMaxPacketSize.'
- lang: es
  value: "En el kernel de Linux, se resolvi\xF3 la siguiente vulnerabilidad: comedi:\
    \ vmk80xx: corrige desbordamientos del b\xFAfer de transferencia El controlador\
    \ utiliza b\xFAferes de transferencia USB del tama\xF1o de un terminal, pero hasta\
    \ hace poco no ten\xEDa controles de cordura sobre los tama\xF1os. el commit e1f13c879a7c\
    \ (\"staging: comedi: verificar la validez de wMaxPacketSize de los endpoints\
    \ USB encontrados\") corrigi\xF3 inadvertidamente las desreferencias de puntero\
    \ NULL al acceder a los buffers de transferencia en caso de que un dispositivo\
    \ malicioso tenga un wMaxPacketSize cero. Aseg\xFArese de asignar buffers lo suficientemente\
    \ grandes para manejar tambi\xE9n los otros accesos que se realizan sin una verificaci\xF3\
    n de tama\xF1o (por ejemplo, el byte 18 en vmk80xx_cnt_insn_read() para VMK8061_MODEL)\
    \ para evitar escribir m\xE1s all\xE1 de los buffers, por ejemplo, cuando se realiza\
    \ una confusi\xF3n de descriptores. El controlador original era para un dispositivo\
    \ de baja velocidad con buffers de 8 bytes. Posteriormente se agreg\xF3 soporte\
    \ para un dispositivo que utiliza transferencias masivas y presumiblemente es\
    \ un dispositivo de velocidad completa con un wMaxPacketSize m\xE1ximo de 64 bytes."
id: CVE-2021-47475
lastModified: '2024-05-22T12:46:53.887'
metrics: {}
published: '2024-05-22T09:15:09.370'
references:
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/06ac746d57e6d32b062e220415c607b7e2e0fa50
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/199acd8c110e3ae62833c24f632b0bb1c9f012a9
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/278484ae93297b1bb1ce755f9d3b6d95a48c7d47
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/33d7a470730dfe7c9bfc8da84575cf2cedd60d00
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/40d2a7e278e2e7c0a5fd7e997e7eb63945bf93f7
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/5229159f1d052821007aff1a1beb7873eacf1a9f
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/7a2021b896de1ad559d33b5c5cdd20b982242088
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/a23461c47482fc232ffc9b819539d1f837adf2b1
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/ec85bcff4ed09260243d8f39faba99e1041718ba
sourceIdentifier: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
vulnStatus: Awaiting Analysis
