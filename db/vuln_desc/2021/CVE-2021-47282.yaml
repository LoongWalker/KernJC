descriptions:
- lang: en
  value: 'In the Linux kernel, the following vulnerability has been resolved:


    spi: bcm2835: Fix out-of-bounds access with more than 4 slaves


    Commit 571e31fa60b3 ("spi: bcm2835: Cache CS register value for

    ->prepare_message()") limited the number of slaves to 3 at compile-time.

    The limitation was necessitated by a statically-sized array prepare_cs[]

    in the driver private data which contains a per-slave register value.


    The commit sought to enforce the limitation at run-time by setting the

    controller''s num_chipselect to 3:  Slaves with a higher chipselect are

    rejected by spi_add_device().


    However the commit neglected that num_chipselect only limits the number

    of *native* chipselects.  If GPIO chipselects are specified in the

    device tree for more than 3 slaves, num_chipselect is silently raised by

    of_spi_get_gpio_numbers() and the result are out-of-bounds accesses to

    the statically-sized array prepare_cs[].


    As a bandaid fix which is backportable to stable, raise the number of

    allowed slaves to 24 (which "ought to be enough for anybody"), enforce

    the limitation on slave ->setup and revert num_chipselect to 3 (which is

    the number of native chipselects supported by the controller).

    An upcoming for-next commit will allow an arbitrary number of slaves.'
- lang: es
  value: "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: spi:\
    \ bcm2835: corrige el acceso fuera de los l\xEDmites con m\xE1s de 4 esclavos.\
    \ La confirmaci\xF3n 571e31fa60b3 (\"spi: bcm2835: valor de registro CS de cach\xE9\
    \ para -&gt;prepare_message()\") limit\xF3 el n\xFAmero de esclavos a 3 en tiempo\
    \ de compilaci\xF3n. La limitaci\xF3n fue necesaria por una matriz de tama\xF1\
    o est\xE1tico prepare_cs[] en los datos privados del controlador que contiene\
    \ un valor de registro por esclavo. La confirmaci\xF3n buscaba hacer cumplir la\
    \ limitaci\xF3n en tiempo de ejecuci\xF3n estableciendo num_chipselect del controlador\
    \ en 3: spi_add_device() rechaza los esclavos con una selecci\xF3n de chip m\xE1\
    s alta. Sin embargo, la confirmaci\xF3n omiti\xF3 que num_chipselect solo limita\
    \ el n\xFAmero de selecciones de chips *nativas*. Si se especifican selecciones\
    \ de chips GPIO en el \xE1rbol de dispositivos para m\xE1s de 3 esclavos, of_spi_get_gpio_numbers()\
    \ genera silenciosamente num_chipselect y el resultado son accesos fuera de los\
    \ l\xEDmites a la matriz de tama\xF1o est\xE1tico prepare_cs[]. Como soluci\xF3\
    n curita que se puede volver a transferir a estable, aumente la cantidad de esclavos\
    \ permitidos a 24 (lo que \"deber\xEDa ser suficiente para cualquiera\"), aplique\
    \ la limitaci\xF3n en esclavo -&gt; configuraci\xF3n y revierta num_chipselect\
    \ a 3 (que es la cantidad de nativos selecciones de chips admitidas por el controlador).\
    \ Una pr\xF3xima confirmaci\xF3n para la pr\xF3xima permitir\xE1 una cantidad\
    \ arbitraria de esclavos."
id: CVE-2021-47282
lastModified: '2024-05-21T16:54:26.047'
metrics: {}
published: '2024-05-21T15:15:16.430'
references:
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/01415ff85a24308059e06ca3e97fd7bf75648690
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/13817d466eb8713a1ffd254f537402f091d48444
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/82a8ffba54d31e97582051cb56ba1f988018681e
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/b5502580cf958b094f3b69dfe4eece90eae01fbc
sourceIdentifier: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
vulnStatus: Awaiting Analysis
