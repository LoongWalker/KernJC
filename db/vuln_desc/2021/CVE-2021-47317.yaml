cveTags: []
descriptions:
- lang: en
  value: 'In the Linux kernel, the following vulnerability has been resolved:


    powerpc/bpf: Fix detecting BPF atomic instructions


    Commit 91c960b0056672 ("bpf: Rename BPF_XADD and prepare to encode other

    atomics in .imm") converted BPF_XADD to BPF_ATOMIC and added a way to

    distinguish instructions based on the immediate field. Existing JIT

    implementations were updated to check for the immediate field and to

    reject programs utilizing anything more than BPF_ADD (such as BPF_FETCH)

    in the immediate field.


    However, the check added to powerpc64 JIT did not look at the correct

    BPF instruction. Due to this, such programs would be accepted and

    incorrectly JIT''ed resulting in soft lockups, as seen with the atomic

    bounds test. Fix this by looking at the correct immediate value.'
- lang: es
  value: "En el kernel de Linux, se resolvi\xF3 la siguiente vulnerabilidad: powerpc/bpf:\
    \ Correcci\xF3n de la detecci\xF3n de instrucciones at\xF3micas BPF. La confirmaci\xF3\
    n 91c960b0056672 (\"bpf: Renombrar BPF_XADD y prepararse para codificar otros\
    \ \xE1tomos en .imm\") convirti\xF3 BPF_XADD a BPF_ATOMIC y agreg\xF3 una forma\
    \ de distinguir instrucciones basadas en el campo inmediato. Las implementaciones\
    \ JIT existentes se actualizaron para verificar el campo inmediato y rechazar\
    \ programas que utilicen algo m\xE1s que BPF_ADD (como BPF_FETCH) en el campo\
    \ inmediato. Sin embargo, la verificaci\xF3n agregada a powerpc64 JIT no analiz\xF3\
    \ la instrucci\xF3n BPF correcta. Debido a esto, dichos programas ser\xEDan aceptados\
    \ y sometidos a JIT incorrectamente, lo que provocar\xEDa bloqueos suaves, como\
    \ se ve con la prueba de l\xEDmites at\xF3micos. Solucione este problema observando\
    \ el valor inmediato correcto."
id: CVE-2021-47317
lastModified: '2024-05-21T16:54:26.047'
metrics: {}
published: '2024-05-21T15:15:19.007'
references:
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/0d435b6d94b05dcfd836d758a63145aa566618e2
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/419ac821766cbdb9fd85872bb3f1a589df05c94c
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/7284dab07e4d51d453cc42851fae9ec4fac6ef2f
sourceIdentifier: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
vulnStatus: Awaiting Analysis
