descriptions:
- lang: en
  value: 'In the Linux kernel, the following vulnerability has been resolved:


    nvmet: fix freeing unallocated p2pmem


    In case p2p device was found but the p2p pool is empty, the nvme target

    is still trying to free the sgl from the p2p pool instead of the

    regular sgl pool and causing a crash (BUG() is called). Instead, assign

    the p2p_dev for the request only if it was allocated from p2p pool.


    This is the crash that was caused:


    [Sun May 30 19:13:53 2021] ------------[ cut here ]------------

    [Sun May 30 19:13:53 2021] kernel BUG at lib/genalloc.c:518!

    [Sun May 30 19:13:53 2021] invalid opcode: 0000 [#1] SMP PTI

    ...

    [Sun May 30 19:13:53 2021] kernel BUG at lib/genalloc.c:518!

    ...

    [Sun May 30 19:13:53 2021] RIP: 0010:gen_pool_free_owner+0xa8/0xb0

    ...

    [Sun May 30 19:13:53 2021] Call Trace:

    [Sun May 30 19:13:53 2021] ------------[ cut here ]------------

    [Sun May 30 19:13:53 2021]  pci_free_p2pmem+0x2b/0x70

    [Sun May 30 19:13:53 2021]  pci_p2pmem_free_sgl+0x4f/0x80

    [Sun May 30 19:13:53 2021]  nvmet_req_free_sgls+0x1e/0x80 [nvmet]

    [Sun May 30 19:13:53 2021] kernel BUG at lib/genalloc.c:518!

    [Sun May 30 19:13:53 2021]  nvmet_rdma_release_rsp+0x4e/0x1f0 [nvmet_rdma]

    [Sun May 30 19:13:53 2021]  nvmet_rdma_send_done+0x1c/0x60 [nvmet_rdma]'
- lang: es
  value: "En el kernel de Linux, se resolvi\xF3 la siguiente vulnerabilidad: nvmet:\
    \ soluci\xF3n que libera p2pmem no asignado En caso de que se encuentre un dispositivo\
    \ p2p pero el grupo p2p est\xE9 vac\xEDo, el objetivo nvme todav\xEDa est\xE1\
    \ intentando liberar el sgl del grupo p2p en lugar del sgl normal. pool y provocando\
    \ un bloqueo (se llama a BUG()). En su lugar, asigne p2p_dev para la solicitud\
    \ solo si se asign\xF3 desde el grupo p2p. Este es el accidente que se provoc\xF3\
    : [domingo 30 de mayo 19:13:53 2021] ------------[ cortar aqu\xED ]------------\
    \ [domingo de mayo 30 19:13:53 2021] \xA1ERROR del kernel en lib/genalloc.c:518!\
    \ [domingo 30 de mayo 19:13:53 2021] c\xF3digo de operaci\xF3n no v\xE1lido: 0000\
    \ [#1] SMP PTI... [domingo 30 de mayo 19:13:53 2021] ERROR del kernel en lib/genalloc.c:518.\
    \ ... [dom 30 de mayo 19:13:53 2021] RIP: 0010:gen_pool_free_owner+0xa8/0xb0 ...\
    \ [dom 30 de mayo 19:13:53 2021] Seguimiento de llamadas: [dom 30 de mayo 19:13:53\
    \ 2021 ] ------------[ cortar aqu\xED ]------------ [domingo 30 de mayo 19:13:53\
    \ 2021] pci_free_p2pmem+0x2b/0x70 [domingo 30 de mayo 19 :13:53 2021] pci_p2pmem_free_sgl+0x4f/0x80\
    \ [domingo 30 de mayo 19:13:53 2021] nvmet_req_free_sgls+0x1e/0x80 [nvmet] [domingo\
    \ 30 de mayo 19:13:53 2021] ERROR del kernel en lib/genalloc.c: 518! [dom 30 de\
    \ mayo 19:13:53 2021] nvmet_rdma_release_rsp+0x4e/0x1f0 [nvmet_rdma] [dom 30 de\
    \ mayo 19:13:53 2021] nvmet_rdma_send_done+0x1c/0x60 [nvmet_rdma]"
id: CVE-2021-47130
lastModified: '2024-03-17T22:38:29.433'
metrics: {}
published: '2024-03-15T21:15:07.577'
references:
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/8a452d62e7cea3c8a2676a3b89a9118755a1a271
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/bcd9a0797d73eeff659582f23277e7ab6e5f18f3
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/c440cd080761b18a52cac20f2a42e5da1e3995af
sourceIdentifier: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
vulnStatus: Awaiting Analysis
