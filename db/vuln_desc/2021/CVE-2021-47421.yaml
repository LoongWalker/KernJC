cveTags: []
descriptions:
- lang: en
  value: 'In the Linux kernel, the following vulnerability has been resolved:


    drm/amdgpu: handle the case of pci_channel_io_frozen only in amdgpu_pci_resume


    In current code, when a PCI error state pci_channel_io_normal is detectd,

    it will report PCI_ERS_RESULT_CAN_RECOVER status to PCI driver, and PCI

    driver will continue the execution of PCI resume callback report_resume by

    pci_walk_bridge, and the callback will go into amdgpu_pci_resume

    finally, where write lock is releasd unconditionally without acquiring

    such lock first. In this case, a deadlock will happen when other threads

    start to acquire the read lock.


    To fix this, add a member in amdgpu_device strucutre to cache

    pci_channel_state, and only continue the execution in amdgpu_pci_resume

    when it''s pci_channel_io_frozen.'
- lang: es
  value: "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: drm/amdgpu:\
    \ maneja el caso de pci_channel_io_frozen solo en amdgpu_pci_resume. En el c\xF3\
    digo actual, cuando se detecta un estado de error de PCI pci_channel_io_normal,\
    \ informar\xE1 el estado de PCI_ERS_RESULT_CAN_RECOVER al controlador PCI, y el\
    \ controlador PCI contin\xFAe la ejecuci\xF3n de PCI resume callback report_resume\
    \ mediante pci_walk_bridge, y la devoluci\xF3n de llamada finalmente ir\xE1 a\
    \ amdgpu_pci_resume, donde el bloqueo de escritura se libera incondicionalmente\
    \ sin adquirir dicho bloqueo primero. En este caso, se producir\xE1 un punto muerto\
    \ cuando otros subprocesos comiencen a adquirir el bloqueo de lectura. Para solucionar\
    \ este problema, agregue un miembro en la estructura amdgpu_device para almacenar\
    \ en cach\xE9 pci_channel_state y solo contin\xFAe la ejecuci\xF3n en amdgpu_pci_resume\
    \ cuando sea pci_channel_io_frozen."
id: CVE-2021-47421
lastModified: '2024-05-21T16:53:56.550'
metrics: {}
published: '2024-05-21T15:15:27.537'
references:
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/248b061689a40f4fed05252ee2c89f87cf26d7d8
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/72e9a1bf9b722628c28092e0c2cd8717edd201dc
sourceIdentifier: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
vulnStatus: Awaiting Analysis
