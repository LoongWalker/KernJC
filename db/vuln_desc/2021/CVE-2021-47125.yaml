cveTags: []
descriptions:
- lang: en
  value: 'In the Linux kernel, the following vulnerability has been resolved:


    sch_htb: fix refcount leak in htb_parent_to_leaf_offload


    The commit ae81feb7338c ("sch_htb: fix null pointer dereference

    on a null new_q") fixes a NULL pointer dereference bug, but it

    is not correct.


    Because htb_graft_helper properly handles the case when new_q

    is NULL, and after the previous patch by skipping this call

    which creates an inconsistency : dev_queue->qdisc will still

    point to the old qdisc, but cl->parent->leaf.q will point to

    the new one (which will be noop_qdisc, because new_q was NULL).

    The code is based on an assumption that these two pointers are

    the same, so it can lead to refcount leaks.


    The correct fix is to add a NULL pointer check to protect

    qdisc_refcount_inc inside htb_parent_to_leaf_offload.'
- lang: es
  value: "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: sch_htb:\
    \ corrige la fuga de recuento en htb_parent_to_leaf_offload el commit ae81feb7338c\
    \ (\"sch_htb: corrige la desreferencia del puntero nulo en un new_q nulo\") corrige\
    \ un error de desreferencia del puntero NULL, pero no es correcto. Debido a que\
    \ htb_graft_helper maneja adecuadamente el caso cuando new_q es NULL, y despu\xE9\
    s del parche anterior al omitir esta llamada, se crea una inconsistencia: dev_queue-&gt;qdisc\
    \ seguir\xE1 apuntando a la qdisc anterior, pero cl-&gt;parent-&gt;leaf.q apuntar\xE1\
    \ a el nuevo (que ser\xE1 noop_qdisc, porque new_q era NULL). El c\xF3digo se\
    \ basa en la suposici\xF3n de que estos dos indicadores son iguales, por lo que\
    \ puede provocar fugas de recuento. La soluci\xF3n correcta es agregar una verificaci\xF3\
    n de puntero NULL para proteger qdisc_refcount_inc dentro de htb_parent_to_leaf_offload."
id: CVE-2021-47125
lastModified: '2024-03-17T22:38:29.433'
metrics: {}
published: '2024-03-15T21:15:07.307'
references:
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/2411c02d03892a5057499f8102d0cc1e0f852416
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/944d671d5faa0d78980a3da5c0f04960ef1ad893
sourceIdentifier: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
vulnStatus: Awaiting Analysis
