cveTags: []
descriptions:
- lang: en
  value: 'In the Linux kernel, the following vulnerability has been resolved:


    KVM: SVM: Make sure GHCB is mapped before updating


    Access to the GHCB is mainly in the VMGEXIT path and it is known that the

    GHCB will be mapped. But there are two paths where it is possible the GHCB

    might not be mapped.


    The sev_vcpu_deliver_sipi_vector() routine will update the GHCB to inform

    the caller of the AP Reset Hold NAE event that a SIPI has been delivered.

    However, if a SIPI is performed without a corresponding AP Reset Hold,

    then the GHCB might not be mapped (depending on the previous VMEXIT),

    which will result in a NULL pointer dereference.


    The svm_complete_emulated_msr() routine will update the GHCB to inform

    the caller of a RDMSR/WRMSR operation about any errors. While it is likely

    that the GHCB will be mapped in this situation, add a safe guard

    in this path to be certain a NULL pointer dereference is not encountered.'
- lang: es
  value: "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: KVM:\
    \ SVM: aseg\xFArese de que GHCB est\xE9 mapeado antes de actualizar. El acceso\
    \ al GHCB se encuentra principalmente en la ruta VMGEXIT y se sabe que el GHCB\
    \ ser\xE1 mapeado. Pero hay dos caminos en los que es posible que el GHCB no est\xE9\
    \ mapeado. La rutina sev_vcpu_deliver_sipi_vector() actualizar\xE1 el GHCB para\
    \ informar a la persona que llama del evento AP Reset Hold NAE que se ha entregado\
    \ un SIPI. Sin embargo, si se realiza una SIPI sin una retenci\xF3n de reinicio\
    \ de AP correspondiente, es posible que el GHCB no se asigne (dependiendo del\
    \ VMEXIT anterior), lo que resultar\xE1 en una desreferencia del puntero NULL.\
    \ La rutina svm_complete_emulated_msr() actualizar\xE1 el GHCB para informar a\
    \ la persona que llama de una operaci\xF3n RDMSR/WRMSR sobre cualquier error.\
    \ Si bien es probable que el GHCB se asigne en esta situaci\xF3n, agregue una\
    \ protecci\xF3n en esta ruta para asegurarse de que no se encuentre una desreferencia\
    \ de puntero NULL."
id: CVE-2021-47008
lastModified: '2024-02-28T14:06:45.783'
metrics: {}
published: '2024-02-28T09:15:38.560'
references:
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/a3ba26ecfb569f4aa3f867e80c02aa65f20aadad
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/fb9e14f4f8217a0980f8da2c8ff70dee058cbe47
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/fd722a57fe0b80133dacae4e1c852ee4212f9b2e
sourceIdentifier: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
vulnStatus: Awaiting Analysis
