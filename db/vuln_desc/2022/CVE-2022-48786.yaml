cveTags: []
descriptions:
- lang: en
  value: 'In the Linux kernel, the following vulnerability has been resolved:


    vsock: remove vsock from connected table when connect is interrupted by a signal


    vsock_connect() expects that the socket could already be in the

    TCP_ESTABLISHED state when the connecting task wakes up with a signal

    pending. If this happens the socket will be in the connected table, and

    it is not removed when the socket state is reset. In this situation it''s

    common for the process to retry connect(), and if the connection is

    successful the socket will be added to the connected table a second

    time, corrupting the list.


    Prevent this by calling vsock_remove_connected() if a signal is received

    while waiting for a connection. This is harmless if the socket is not in

    the connected table, and if it is in the table then removing it will

    prevent list corruption from a double add.


    Note for backporting: this patch requires d5afa82c977e ("vsock: correct

    removal of socket from the list"), which is in all current stable trees

    except 4.9.y.'
- lang: es
  value: "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: vsock:\
    \ elimina vsock de la tabla conectada cuando la conexi\xF3n es interrumpida por\
    \ una se\xF1al vsock_connect() espera que el socket ya est\xE9 en el estado TCP_ESTABLISHED\
    \ cuando la tarea de conexi\xF3n se activa con una se\xF1al pendiente. Si esto\
    \ sucede, el socket estar\xE1 en la tabla conectada y no se eliminar\xE1 cuando\
    \ se restablezca el estado del socket. En esta situaci\xF3n, es com\xFAn que el\
    \ proceso vuelva a intentar conectar() y, si la conexi\xF3n es exitosa, el socket\
    \ se agregar\xE1 a la tabla conectada por segunda vez, corrompiendo la lista.\
    \ Evite esto llamando a vsock_remove_connected() si se recibe una se\xF1al mientras\
    \ se espera una conexi\xF3n. Esto es inofensivo si el socket no est\xE1 en la\
    \ tabla conectada, y si est\xE1 en la tabla, eliminarlo evitar\xE1 la corrupci\xF3\
    n de la lista debido a una doble adici\xF3n. Nota para la compatibilidad: este\
    \ parche requiere d5afa82c977e (\"vsock: eliminaci\xF3n correcta del socket de\
    \ la lista\"), que se encuentra en todos los \xE1rboles estables actuales excepto\
    \ 4.9.y."
id: CVE-2022-48786
lastModified: '2024-07-16T13:43:58.773'
metrics: {}
published: '2024-07-16T12:15:03.560'
references:
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/0bb88f3f7e8d506f3efe46d694964117e20efbfc
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/2910bcb9f67551a45397735e47b6d456eb8cd549
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/5f326fe2aef411a6575628f92bd861463ea91df7
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/787468ee7a435777521d33399d012fd591ae2f94
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/87cd1bbd6677411e17369cd4b7389ab1e1fdba44
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/addd62a8cb6fa90aa322365c62487da61f6baab8
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/b9208492fcaecff8f43915529ae34b3bcb03877c
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/e3b3939fd137aab6d00d54bee0ee9244b286a608
sourceIdentifier: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
vulnStatus: Awaiting Analysis
