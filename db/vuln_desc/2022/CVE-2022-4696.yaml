configurations:
- nodes:
  - cpeMatch:
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 8919F320-7EC7-47EF-AFA9-126CDF30AB7B
      versionEndExcluding: '5.12'
      versionStartIncluding: '5.10'
      vulnerable: true
    negate: false
    operator: OR
descriptions:
- lang: en
  value: There exists a use-after-free vulnerability in the Linux kernel through io_uring
    and the IORING_OP_SPLICE operation. If IORING_OP_SPLICE is missing the IO_WQ_WORK_FILES
    flag, which signals that the operation won't use current->nsproxy, so its reference
    counter is not increased. This assumption is not always true as calling io_splice
    on specific files will call the get_uts function which will use current->nsproxy
    leading to invalidly decreasing its reference counter later causing the use-after-free
    vulnerability. We recommend upgrading to version 5.10.160 or above
id: CVE-2022-4696
lastModified: '2023-05-12T13:30:58.023'
metrics:
  cvssMetricV31:
  - cvssData:
      attackComplexity: LOW
      attackVector: LOCAL
      availabilityImpact: HIGH
      baseScore: 7.8
      baseSeverity: HIGH
      confidentialityImpact: HIGH
      integrityImpact: HIGH
      privilegesRequired: LOW
      scope: UNCHANGED
      userInteraction: NONE
      vectorString: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
      version: '3.1'
    exploitabilityScore: 1.8
    impactScore: 5.9
    source: nvd@nist.gov
    type: Primary
  - cvssData:
      attackComplexity: LOW
      attackVector: LOCAL
      availabilityImpact: HIGH
      baseScore: 7.8
      baseSeverity: HIGH
      confidentialityImpact: HIGH
      integrityImpact: HIGH
      privilegesRequired: LOW
      scope: UNCHANGED
      userInteraction: NONE
      vectorString: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
      version: '3.1'
    exploitabilityScore: 1.8
    impactScore: 5.9
    source: cve-coordination@google.com
    type: Secondary
published: '2023-01-11T13:15:09.307'
references:
- source: cve-coordination@google.com
  tags:
  - Mailing List
  - Patch
  - Vendor Advisory
  url: https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?h=linux-5.10.y&id=75454b4bbfc7e6a4dd8338556f36ea9107ddf61a
- source: cve-coordination@google.com
  tags:
  - Exploit
  - Third Party Advisory
  url: https://kernel.dance/#75454b4bbfc7e6a4dd8338556f36ea9107ddf61a
sourceIdentifier: cve-coordination@google.com
vulnStatus: Analyzed
weaknesses:
- description:
  - lang: en
    value: CWE-416
  source: nvd@nist.gov
  type: Primary
- description:
  - lang: en
    value: CWE-763
  source: cve-coordination@google.com
  type: Secondary
