cveTags: []
descriptions:
- lang: en
  value: 'In the Linux kernel, the following vulnerability has been resolved:


    misc: fastrpc: avoid double fput() on failed usercopy


    If the copy back to userland fails for the FASTRPC_IOCTL_ALLOC_DMA_BUFF

    ioctl(), we shouldn''t assume that ''buf->dmabuf'' is still valid. In fact,

    dma_buf_fd() called fd_install() before, i.e. "consumed" one reference,

    leaving us with none.


    Calling dma_buf_put() will therefore put a reference we no longer own,

    leading to a valid file descritor table entry for an already released

    ''file'' object which is a straight use-after-free.


    Simply avoid calling dma_buf_put() and rely on the process exit code to

    do the necessary cleanup, if needed, i.e. if the file descriptor is

    still valid.'
- lang: es
  value: "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: misc:\
    \ fastrpc: evitar doble fput() en copia de usuario fallida. Si la copia al \xE1\
    rea de usuario falla para FASTRPC_IOCTL_ALLOC_DMA_BUFF ioctl(), no debemos asumir\
    \ que 'buf-&gt;dmabuf' aun es v\xE1lido. De hecho, dma_buf_fd() llam\xF3 a fd_install()\
    \ antes, es decir, \"consumi\xF3\" una referencia, dej\xE1ndonos sin ninguna.\
    \ Por lo tanto, llamar a dma_buf_put() colocar\xE1 una referencia que ya no poseemos,\
    \ lo que conducir\xE1 a una entrada v\xE1lida en la tabla de descripci\xF3n de\
    \ archivos para un objeto 'archivo' ya publicado que es un use-after-free directo.\
    \ Simplemente evite llamar a dma_buf_put() y conf\xEDe en el c\xF3digo de salida\
    \ del proceso para realizar la limpieza necesaria, si es necesario, es decir,\
    \ si el descriptor del archivo a\xFAn es v\xE1lido."
id: CVE-2022-48821
lastModified: '2024-07-16T13:43:58.773'
metrics: {}
published: '2024-07-16T12:15:06.010'
references:
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/46963e2e0629cb31c96b1d47ddd89dc3d8990b34
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/4e6fd2b5fcf8e7119305a6042bd92e7f2b9ed215
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/76f85c307ef9f10aa2cef1b1d5ee654c1f3345fc
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/a5ce7ee5fcc07583159f54ab4af5164de00148f5
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/e4382d0a39f9a1e260d62fdc079ddae5293c037d
sourceIdentifier: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
vulnStatus: Awaiting Analysis
