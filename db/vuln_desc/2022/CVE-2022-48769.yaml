cveTags: []
descriptions:
- lang: en
  value: 'In the Linux kernel, the following vulnerability has been resolved:


    efi: runtime: avoid EFIv2 runtime services on Apple x86 machines


    Aditya reports [0] that his recent MacbookPro crashes in the firmware

    when using the variable services at runtime. The culprit appears to be a

    call to QueryVariableInfo(), which we did not use to call on Apple x86

    machines in the past as they only upgraded from EFI v1.10 to EFI v2.40

    firmware fairly recently, and QueryVariableInfo() (along with

    UpdateCapsule() et al) was added in EFI v2.00.


    The only runtime service introduced in EFI v2.00 that we actually use in

    Linux is QueryVariableInfo(), as the capsule based ones are optional,

    generally not used at runtime (all the LVFS/fwupd firmware update

    infrastructure uses helper EFI programs that invoke capsule update at

    boot time, not runtime), and not implemented by Apple machines in the

    first place. QueryVariableInfo() is used to ''safely'' set variables,

    i.e., only when there is enough space. This prevents machines with buggy

    firmwares from corrupting their NVRAMs when they run out of space.


    Given that Apple machines have been using EFI v1.10 services only for

    the longest time (the EFI v2.0 spec was released in 2006, and Linux

    support for the newly introduced runtime services was added in 2011, but

    the MacbookPro12,1 released in 2015 still claims to be EFI v1.10 only),

    let''s avoid the EFI v2.0 ones on all Apple x86 machines.


    [0] https://lore.kernel.org/all/6D757C75-65B1-468B-842D-10410081A8E4@live.com/'
- lang: es
  value: "En el kernel de Linux, se resolvi\xF3 la siguiente vulnerabilidad: efi:\
    \ runtime: evite los servicios de tiempo de ejecuci\xF3n EFIv2 en m\xE1quinas\
    \ Apple x86 Aditya informa [0] que su reciente MacbookPro falla en el firmware\
    \ cuando usa los servicios variables en tiempo de ejecuci\xF3n. El culpable parece\
    \ ser una llamada a QueryVariableInfo(), que no utilizamos para llamar a m\xE1\
    quinas Apple x86 en el pasado, ya que recientemente se actualizaron del firmware\
    \ EFI v1.10 al firmware EFI v2.40, y QueryVariableInfo() (junto con con UpdateCapsule()\
    \ et al) se agreg\xF3 en EFI v2.00. El \xFAnico servicio de tiempo de ejecuci\xF3\
    n introducido en EFI v2.00 que realmente usamos en Linux es QueryVariableInfo(),\
    \ ya que los basados en c\xE1psulas son opcionales y generalmente no se usan en\
    \ tiempo de ejecuci\xF3n (toda la infraestructura de actualizaci\xF3n de firmware\
    \ LVFS/fwupd utiliza programas EFI auxiliares que invocan la c\xE1psula). actualizar\
    \ en el momento del arranque, no en el tiempo de ejecuci\xF3n) y, en primer lugar,\
    \ no lo implementan las m\xE1quinas Apple. QueryVariableInfo() se utiliza para\
    \ establecer variables de forma \"segura\", es decir, s\xF3lo cuando hay suficiente\
    \ espacio. Esto evita que las m\xE1quinas con firmwares defectuosos da\xF1en sus\
    \ NVRAM cuando se quedan sin espacio. Dado que las m\xE1quinas Apple han estado\
    \ usando los servicios EFI v1.10 solo durante m\xE1s tiempo (la especificaci\xF3\
    n EFI v2.0 se lanz\xF3 en 2006 y el soporte de Linux para los servicios de ejecuci\xF3\
    n recientemente introducidos se agreg\xF3 en 2011, pero el MacbookPro12,1 se lanz\xF3\
    \ en 2015 todav\xEDa afirma ser solo EFI v1.10), evitemos los EFI v2.0 en todas\
    \ las m\xE1quinas Apple x86. [0] https://lore.kernel.org/all/6D757C75-65B1-468B-842D-10410081A8E4@live.com/"
id: CVE-2022-48769
lastModified: '2024-06-20T12:43:25.663'
metrics: {}
published: '2024-06-20T12:15:14.870'
references:
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/3df52448978802ae15dcebf66beba1029df957b4
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/a4085859411c825c321c9b55b8a9dc5a128a6684
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/b0f1cc093bc2493ac259c53766fd2b800e085807
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/f5390cd0b43c2e54c7cf5506c7da4a37c5cef746
sourceIdentifier: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
vulnStatus: Awaiting Analysis
