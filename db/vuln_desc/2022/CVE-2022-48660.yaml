configurations:
- nodes:
  - cpeMatch:
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: C4419CBE-3D18-42F1-B73B-8BA095744DA6
      versionEndExcluding: 5.10.146
      versionStartIncluding: '5.9'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 080C1827-D257-4D5A-9071-779EF7F5EF0B
      versionEndExcluding: 5.15.71
      versionStartIncluding: '5.11'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 03B0F56B-C5CC-4E81-BB51-D07D569DE4CA
      versionEndExcluding: 5.19.12
      versionStartIncluding: '5.16'
      vulnerable: true
    negate: false
    operator: OR
descriptions:
- lang: en
  value: 'In the Linux kernel, the following vulnerability has been resolved:


    gpiolib: cdev: Set lineevent_state::irq after IRQ register successfully


    When running gpio test on nxp-ls1028 platform with below command

    gpiomon --num-events=3 --rising-edge gpiochip1 25

    There will be a warning trace as below:

    Call trace:

    free_irq+0x204/0x360

    lineevent_free+0x64/0x70

    gpio_ioctl+0x598/0x6a0

    __arm64_sys_ioctl+0xb4/0x100

    invoke_syscall+0x5c/0x130

    ......

    el0t_64_sync+0x1a0/0x1a4

    The reason of this issue is that calling request_threaded_irq()

    function failed, and then lineevent_free() is invoked to release

    the resource. Since the lineevent_state::irq was already set, so

    the subsequent invocation of free_irq() would trigger the above

    warning call trace. To fix this issue, set the lineevent_state::irq

    after the IRQ register successfully.'
- lang: es
  value: "En el kernel de Linux, se resolvi\xF3 la siguiente vulnerabilidad: gpiolib:\
    \ cdev: configure lineevent_state::irq despu\xE9s del registro IRQ con \xE9xito\
    \ Al ejecutar la prueba gpio en la plataforma nxp-ls1028 con el siguiente comando\
    \ gpiomon --num-events=3 --rising-edge gpiochip1 25 Habr\xE1 un seguimiento de\
    \ advertencia como se muestra a continuaci\xF3n: Seguimiento de llamada: free_irq+0x204/0x360\
    \ lineevent_free+0x64/0x70 gpio_ioctl+0x598/0x6a0 __arm64_sys_ioctl+0xb4/0x100\
    \ invoke_syscall+0x5c/0x130 ...... 0x1a0/0x1a4 El motivo de este problema es que\
    \ fall\xF3 la llamada a la funci\xF3n request_threaded_irq() y luego se invoca\
    \ lineevent_free() para liberar el recurso. Dado que lineevent_state::irq ya estaba\
    \ configurado, la invocaci\xF3n posterior de free_irq() activar\xEDa el seguimiento\
    \ de llamada de advertencia anterior. Para solucionar este problema, configure\
    \ lineevent_state::irq despu\xE9s del registro IRQ correctamente."
id: CVE-2022-48660
lastModified: '2024-04-30T15:06:08.540'
metrics:
  cvssMetricV31:
  - cvssData:
      attackComplexity: LOW
      attackVector: LOCAL
      availabilityImpact: HIGH
      baseScore: 5.5
      baseSeverity: MEDIUM
      confidentialityImpact: NONE
      integrityImpact: NONE
      privilegesRequired: LOW
      scope: UNCHANGED
      userInteraction: NONE
      vectorString: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
      version: '3.1'
    exploitabilityScore: 1.8
    impactScore: 3.6
    source: nvd@nist.gov
    type: Primary
published: '2024-04-28T13:15:07.853'
references:
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/657803b918e097e47d99d1489da83a603c36bcdd
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/69bef19d6b9700e96285f4b4e28691cda3dcd0d1
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/97da736cd11ae73bdf2f5e21e24446b8349e0168
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/b1489043d3b9004dd8d5a0357b08b5f0e6691c43
sourceIdentifier: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
vulnStatus: Analyzed
weaknesses:
- description:
  - lang: en
    value: NVD-CWE-noinfo
  source: nvd@nist.gov
  type: Primary
