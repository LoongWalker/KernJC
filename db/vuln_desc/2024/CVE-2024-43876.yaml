cveTags: []
descriptions:
- lang: en
  value: 'In the Linux kernel, the following vulnerability has been resolved:


    PCI: rcar: Demote WARN() to dev_warn_ratelimited() in rcar_pcie_wakeup()


    Avoid large backtrace, it is sufficient to warn the user that there has

    been a link problem. Either the link has failed and the system is in need

    of maintenance, or the link continues to work and user has been informed.

    The message from the warning can be looked up in the sources.


    This makes an actual link issue less verbose.


    First of all, this controller has a limitation in that the controller

    driver has to assist the hardware with transition to L1 link state by

    writing L1IATN to PMCTRL register, the L1 and L0 link state switching

    is not fully automatic on this controller.


    In case of an ASMedia ASM1062 PCIe SATA controller which does not support

    ASPM, on entry to suspend or during platform pm_test, the SATA controller

    enters D3hot state and the link enters L1 state. If the SATA controller

    wakes up before rcar_pcie_wakeup() was called and returns to D0, the link

    returns to L0 before the controller driver even started its transition to

    L1 link state. At this point, the SATA controller did send an PM_ENTER_L1

    DLLP to the PCIe controller and the PCIe controller received it, and the

    PCIe controller did set PMSR PMEL1RX bit.


    Once rcar_pcie_wakeup() is called, if the link is already back in L0 state

    and PMEL1RX bit is set, the controller driver has no way to determine if

    it should perform the link transition to L1 state, or treat the link as if

    it is in L0 state. Currently the driver attempts to perform the transition

    to L1 link state unconditionally, which in this specific case fails with a

    PMSR L1FAEG poll timeout, however the link still works as it is already

    back in L0 state.


    Reduce this warning verbosity. In case the link is really broken, the

    rcar_pcie_config_access() would fail, otherwise it will succeed and any

    system with this controller and ASM1062 can suspend without generating

    a backtrace.'
- lang: es
  value: "En el kernel de Linux se ha resuelto la siguiente vulnerabilidad: PCI: rcar:\
    \ Degradar WARN() a dev_warn_ratelimited() en rcar_pcie_wakeup() Evitar un gran\
    \ backtrace, basta con avisar al usuario que ha habido un problema de enlace.\
    \ O el enlace fall\xF3 y el sistema necesita mantenimiento, o el enlace contin\xFA\
    a funcionando y el usuario ha sido informado. El mensaje de la advertencia se\
    \ puede buscar en las fuentes. Esto hace que un problema de enlace real sea menos\
    \ detallado. En primer lugar, este controlador tiene una limitaci\xF3n en el sentido\
    \ de que el controlador del controlador tiene que ayudar al hardware con la transici\xF3\
    n al estado de enlace L1 escribiendo L1IATN en el registro PMCTRL; el cambio de\
    \ estado de enlace L1 y L0 no es completamente autom\xE1tico en este controlador.\
    \ En el caso de un controlador ASMedia ASM1062 PCIe SATA que no admite ASPM, al\
    \ entrar a suspender o durante la plataforma pm_test, el controlador SATA ingresa\
    \ al estado D3hot y el enlace ingresa al estado L1. Si el controlador SATA se\
    \ activa antes de que se llamara a rcar_pcie_wakeup() y regresa a D0, el enlace\
    \ regresa a L0 antes de que el controlador del controlador comenzara su transici\xF3\
    n al estado de enlace L1. En este punto, el controlador SATA envi\xF3 un DLLP\
    \ PM_ENTER_L1 al controlador PCIe y el controlador PCIe lo recibi\xF3, y el controlador\
    \ PCIe configur\xF3 el bit PMSR PMEL1RX. Una vez que se llama a rcar_pcie_wakeup(),\
    \ si el enlace ya est\xE1 nuevamente en el estado L0 y el bit PMEL1RX est\xE1\
    \ configurado, el controlador del controlador no tiene forma de determinar si\
    \ debe realizar la transici\xF3n del enlace al estado L1 o tratar el enlace como\
    \ si estuviera en estado L0. Estado L0. Actualmente, el controlador intenta realizar\
    \ la transici\xF3n al estado del enlace L1 incondicionalmente, lo que en este\
    \ caso espec\xEDfico falla con un tiempo de espera de sondeo PMSR L1FAEG; sin\
    \ embargo, el enlace a\xFAn funciona porque ya est\xE1 nuevamente en el estado\
    \ L0. Reduzca la verbosidad de esta advertencia. En caso de que el enlace est\xE9\
    \ realmente roto, rcar_pcie_config_access() fallar\xE1; de lo contrario, tendr\xE1\
    \ \xE9xito y cualquier sistema con este controlador y ASM1062 puede suspenderse\
    \ sin generar un seguimiento."
id: CVE-2024-43876
lastModified: '2024-08-21T12:30:33.697'
metrics: {}
published: '2024-08-21T01:15:11.973'
references:
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/2ae4769332dfdb97f4b6f5dc9ac8f46d02aaa3df
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/3ff3bdde950f1840df4030726cef156758a244d7
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/526a877c6273d4cd0d0aede84c1d620479764b1c
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/c93637e6a4c4e1d0e85ef7efac78d066bbb24d96
sourceIdentifier: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
vulnStatus: Awaiting Analysis
