configurations:
- nodes:
  - cpeMatch:
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: CFD35FD5-8F34-4C7B-803E-84957DD73AFF
      versionEndExcluding: 6.6.33
      versionStartIncluding: '3.8'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 80550309-67AB-4FD1-AC07-3DED5C4F01B2
      versionEndExcluding: 6.8.12
      versionStartIncluding: '6.7'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: E07124C1-19E8-4D21-828D-9932A01D3011
      versionEndExcluding: 6.9.3
      versionStartIncluding: '6.9'
      vulnerable: true
    negate: false
    operator: OR
cveTags: []
descriptions:
- lang: en
  value: 'In the Linux kernel, the following vulnerability has been resolved:


    gfs2: Fix potential glock use-after-free on unmount


    When a DLM lockspace is released and there ares still locks in that

    lockspace, DLM will unlock those locks automatically.  Commit

    fb6791d100d1b started exploiting this behavior to speed up filesystem

    unmount: gfs2 would simply free glocks it didn''t want to unlock and then

    release the lockspace.  This didn''t take the bast callbacks for

    asynchronous lock contention notifications into account, which remain

    active until until a lock is unlocked or its lockspace is released.


    To prevent those callbacks from accessing deallocated objects, put the

    glocks that should not be unlocked on the sd_dead_glocks list, release

    the lockspace, and only then free those glocks.


    As an additional measure, ignore unexpected ast and bast callbacks if

    the receiving glock is dead.'
- lang: es
  value: "En el kernel de Linux, se resolvi\xF3 la siguiente vulnerabilidad: gfs2:\
    \ soluciona el posible use-after-free de glock al desmontar Cuando se libera un\
    \ espacio de bloqueo de DLM y todav\xEDa hay bloqueos en ese espacio de bloqueo,\
    \ DLM desbloquear\xE1 esos bloqueos autom\xE1ticamente. El commit fb6791d100d1b\
    \ comenz\xF3 a explotar este comportamiento para acelerar el desmontaje del sistema\
    \ de archivos: gfs2 simplemente liberar\xEDa las glocks que no quer\xEDa desbloquear\
    \ y luego liberar\xEDa el espacio de bloqueo. Esto no tuvo en cuenta las devoluciones\
    \ de llamada de bast para notificaciones de contenci\xF3n de bloqueo asincr\xF3\
    nicas, que permanecen activas hasta que se desbloquea un bloqueo o se libera su\
    \ espacio de bloqueo. Para evitar que esas devoluciones de llamada accedan a objetos\
    \ desasignados, coloque las glocks que no deben desbloquearse en la lista sd_dead_glocks,\
    \ libere el espacio de bloqueo y solo entonces libere esas glocks. Como medida\
    \ adicional, ignore las devoluciones de llamada inesperadas de ast y bast si la\
    \ glock receptora est\xE1 muerta."
id: CVE-2024-38570
lastModified: '2024-08-01T20:25:42.533'
metrics:
  cvssMetricV31:
  - cvssData:
      attackComplexity: LOW
      attackVector: LOCAL
      availabilityImpact: HIGH
      baseScore: 7.8
      baseSeverity: HIGH
      confidentialityImpact: HIGH
      integrityImpact: HIGH
      privilegesRequired: LOW
      scope: UNCHANGED
      userInteraction: NONE
      vectorString: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
      version: '3.1'
    exploitabilityScore: 1.8
    impactScore: 5.9
    source: nvd@nist.gov
    type: Primary
published: '2024-06-19T14:15:17.153'
references:
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/0636b34b44589b142700ac137b5f69802cfe2e37
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/501cd8fabf621d10bd4893e37f6ce6c20523c8ca
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/d98779e687726d8f8860f1c54b5687eec5f63a73
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/e42e8a24d7f02d28763d16ca7ec5fc6d1f142af0
sourceIdentifier: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
vulnStatus: Analyzed
weaknesses:
- description:
  - lang: en
    value: CWE-416
  source: nvd@nist.gov
  type: Primary
