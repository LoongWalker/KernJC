configurations:
- nodes:
  - cpeMatch:
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: A6E19FC1-2A3F-4FF8-805C-2864C71553EC
      versionEndExcluding: 4.19.311
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 620FD8B7-BF03-43E0-951A-0A58461D4C55
      versionEndExcluding: 5.4.273
      versionStartIncluding: '4.20'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 65987874-467B-4D3B-91D6-68A129B34FB8
      versionEndExcluding: 5.10.214
      versionStartIncluding: '5.5'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: ACB69438-845D-4E3C-B114-3140611F9C0B
      versionEndExcluding: 5.15.153
      versionStartIncluding: '5.11'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 121A07F6-F505-4C47-86BF-9BB6CC7B6C19
      versionEndExcluding: 6.1.83
      versionStartIncluding: '5.16'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: E00814DC-0BA7-431A-9926-80FEB4A96C68
      versionEndExcluding: 6.6.23
      versionStartIncluding: '6.2'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 9B95D3A6-E162-47D5-ABFC-F3FA74FA7CFD
      versionEndExcluding: 6.7.11
      versionStartIncluding: '6.7'
      vulnerable: true
    negate: false
    operator: OR
descriptions:
- lang: en
  value: 'In the Linux kernel, the following vulnerability has been resolved:


    Bluetooth: rfcomm: Fix null-ptr-deref in rfcomm_check_security


    During our fuzz testing of the connection and disconnection process at the

    RFCOMM layer, we discovered this bug. By comparing the packets from a

    normal connection and disconnection process with the testcase that

    triggered a KASAN report. We analyzed the cause of this bug as follows:


    1. In the packets captured during a normal connection, the host sends a

    `Read Encryption Key Size` type of `HCI_CMD` packet

    (Command Opcode: 0x1408) to the controller to inquire the length of

    encryption key.After receiving this packet, the controller immediately

    replies with a Command Completepacket (Event Code: 0x0e) to return the

    Encryption Key Size.


    2. In our fuzz test case, the timing of the controller''s response to this

    packet was delayed to an unexpected point: after the RFCOMM and L2CAP

    layers had disconnected but before the HCI layer had disconnected.


    3. After receiving the Encryption Key Size Response at the time described

    in point 2, the host still called the rfcomm_check_security function.

    However, by this time `struct l2cap_conn *conn = l2cap_pi(sk)->chan->conn;`

    had already been released, and when the function executed

    `return hci_conn_security(conn->hcon, d->sec_level, auth_type, d->out);`,

    specifically when accessing `conn->hcon`, a null-ptr-deref error occurred.


    To fix this bug, check if `sk->sk_state` is BT_CLOSED before calling

    rfcomm_recv_frame in rfcomm_process_rx.'
- lang: es
  value: "En el kernel de Linux, se resolvi\xF3 la siguiente vulnerabilidad: Bluetooth:\
    \ rfcomm: corrija null-ptr-deref en rfcomm_check_security Durante nuestras pruebas\
    \ preliminares del proceso de conexi\xF3n y desconexi\xF3n en la capa RFCOMM,\
    \ descubrimos este error. Comparando los paquetes de un proceso normal de conexi\xF3\
    n y desconexi\xF3n con el caso de prueba que desencaden\xF3 un informe KASAN.\
    \ Analizamos la causa de este error de la siguiente manera: 1. En los paquetes\
    \ capturados durante una conexi\xF3n normal, el host env\xEDa un paquete `HCI_CMD`\
    \ del tipo `Read Encryption Key Size` (c\xF3digo de operaci\xF3n de comando: 0x1408)\
    \ al controlador para consultar la longitud. de clave de cifrado. Despu\xE9s de\
    \ recibir este paquete, el controlador responde inmediatamente con un paquete\
    \ de comando completo (c\xF3digo de evento: 0x0e) para devolver el tama\xF1o de\
    \ la clave de cifrado. 2. En nuestro caso de prueba fuzz, el tiempo de respuesta\
    \ del controlador a este paquete se retras\xF3 hasta un punto inesperado: despu\xE9\
    s de que las capas RFCOMM y L2CAP se desconectaran, pero antes de que se desconectara\
    \ la capa HCI. 3. Despu\xE9s de recibir la respuesta del tama\xF1o de la clave\
    \ de cifrado en el momento descrito en el punto 2, el host a\xFAn llam\xF3 a la\
    \ funci\xF3n rfcomm_check_security. Sin embargo, en ese momento `struct l2cap_conn\
    \ *conn = l2cap_pi(sk)-&gt;chan-&gt;conn;` ya se hab\xEDa lanzado, y cuando se\
    \ ejecut\xF3 la funci\xF3n `return hci_conn_security(conn-&gt;hcon, d-&gt;sec_level,\
    \ auth_type, d -&gt;out);`, espec\xEDficamente al acceder a `conn-&gt;hcon`, ocurri\xF3\
    \ un error null-ptr-deref. Para corregir este error, verifique si `sk-&gt;sk_state`\
    \ est\xE1 BT_CLOSED antes de llamar a rfcomm_recv_frame en rfcomm_process_rx."
id: CVE-2024-26903
lastModified: '2024-06-25T22:15:25.773'
metrics:
  cvssMetricV31:
  - cvssData:
      attackComplexity: LOW
      attackVector: LOCAL
      availabilityImpact: HIGH
      baseScore: 5.5
      baseSeverity: MEDIUM
      confidentialityImpact: NONE
      integrityImpact: NONE
      privilegesRequired: LOW
      scope: UNCHANGED
      userInteraction: NONE
      vectorString: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
      version: '3.1'
    exploitabilityScore: 1.8
    impactScore: 3.6
    source: nvd@nist.gov
    type: Primary
published: '2024-04-17T11:15:11.060'
references:
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/2535b848fa0f42ddff3e5255cf5e742c9b77bb26
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/369f419c097e82407dd429a202cde9a73d3ae29b
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/3ead59bafad05f2967ae2438c0528d53244cfde5
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/567c0411dc3b424fc7bd1e6109726d7ba32d4f73
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/5f369efd9d963c1f711a06c9b8baf9f5ce616d85
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/5f9fe302dd3a9bbc50f4888464c1773f45166bfd
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/81d7d920a22fd58ef9aedb1bd0a68ee32bd23e96
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/8d1753973f598531baaa2c1033cf7f7b5bb004b0
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://lists.debian.org/debian-lts-announce/2024/06/msg00017.html
sourceIdentifier: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
vulnStatus: Modified
weaknesses:
- description:
  - lang: en
    value: CWE-476
  source: nvd@nist.gov
  type: Primary
