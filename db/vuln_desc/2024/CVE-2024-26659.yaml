cveTags: []
descriptions:
- lang: en
  value: 'In the Linux kernel, the following vulnerability has been resolved:


    xhci: handle isoc Babble and Buffer Overrun events properly


    xHCI 4.9 explicitly forbids assuming that the xHC has released its

    ownership of a multi-TRB TD when it reports an error on one of the

    early TRBs. Yet the driver makes such assumption and releases the TD,

    allowing the remaining TRBs to be freed or overwritten by new TDs.


    The xHC should also report completion of the final TRB due to its IOC

    flag being set by us, regardless of prior errors. This event cannot

    be recognized if the TD has already been freed earlier, resulting in

    "Transfer event TRB DMA ptr not part of current TD" error message.


    Fix this by reusing the logic for processing isoc Transaction Errors.

    This also handles hosts which fail to report the final completion.


    Fix transfer length reporting on Babble errors. They may be caused by

    device malfunction, no guarantee that the buffer has been filled.'
- lang: es
  value: "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: xhci:\
    \ maneja correctamente los eventos isoc Babble y Buffer Overrun xHCI 4.9 proh\xED\
    be expl\xEDcitamente suponer que xHC ha liberado su propiedad de un TD multi-TRB\
    \ cuando informa un error en uno de los primeros TRB. Sin embargo, el conductor\
    \ hace tal suposici\xF3n y libera el TD, permitiendo que los TRB restantes sean\
    \ liberados o sobrescritos por nuevos TD. El xHC tambi\xE9n debe informar la finalizaci\xF3\
    n del TRB final debido a que nosotros establecimos la bandera del COI, independientemente\
    \ de los errores anteriores. Este evento no se puede reconocer si el TD ya se\
    \ liber\xF3 anteriormente, lo que genera el mensaje de error \"Evento de transferencia\
    \ TRB DMA ptr no forma parte del TD actual\". Solucione este problema reutilizando\
    \ la l\xF3gica para procesar errores de transacci\xF3n isoc. Esto tambi\xE9n maneja\
    \ los hosts que no informan la finalizaci\xF3n final. Se corrigi\xF3 el informe\
    \ de duraci\xF3n de la transferencia sobre errores de Babble. Pueden deberse a\
    \ un mal funcionamiento del dispositivo, no hay garant\xEDa de que se haya llenado\
    \ el b\xFAfer."
id: CVE-2024-26659
lastModified: '2024-06-25T22:15:20.220'
metrics: {}
published: '2024-04-02T07:15:42.980'
references:
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/2aa7bcfdbb46241c701811bbc0d64d7884e3346c
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/2e3ec80ea7ba58bbb210e83b5a0afefee7c171d3
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/418456c0ce56209610523f21734c5612ee634134
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/696e4112e5c1ee61996198f0ebb6ca3fab55166e
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/7c4650ded49e5b88929ecbbb631efb8b0838e811
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/f5e7ffa9269a448a720e21f1ed1384d118298c97
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://lists.debian.org/debian-lts-announce/2024/06/msg00017.html
sourceIdentifier: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
vulnStatus: Awaiting Analysis
