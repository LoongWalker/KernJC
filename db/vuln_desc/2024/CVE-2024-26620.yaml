descriptions:
- lang: en
  value: 'In the Linux kernel, the following vulnerability has been resolved:


    s390/vfio-ap: always filter entire AP matrix


    The vfio_ap_mdev_filter_matrix function is called whenever a new adapter or

    domain is assigned to the mdev. The purpose of the function is to update

    the guest''s AP configuration by filtering the matrix of adapters and

    domains assigned to the mdev. When an adapter or domain is assigned, only

    the APQNs associated with the APID of the new adapter or APQI of the new

    domain are inspected. If an APQN does not reference a queue device bound to

    the vfio_ap device driver, then it''s APID will be filtered from the mdev''s

    matrix when updating the guest''s AP configuration.


    Inspecting only the APID of the new adapter or APQI of the new domain will

    result in passing AP queues through to a guest that are not bound to the

    vfio_ap device driver under certain circumstances. Consider the following:


    guest''s AP configuration (all also assigned to the mdev''s matrix):

    14.0004

    14.0005

    14.0006

    16.0004

    16.0005

    16.0006


    unassign domain 4

    unbind queue 16.0005

    assign domain 4


    When domain 4 is re-assigned, since only domain 4 will be inspected, the

    APQNs that will be examined will be:

    14.0004

    16.0004


    Since both of those APQNs reference queue devices that are bound to the

    vfio_ap device driver, nothing will get filtered from the mdev''s matrix

    when updating the guest''s AP configuration. Consequently, queue 16.0005

    will get passed through despite not being bound to the driver. This

    violates the linux device model requirement that a guest shall only be

    given access to devices bound to the device driver facilitating their

    pass-through.


    To resolve this problem, every adapter and domain assigned to the mdev will

    be inspected when filtering the mdev''s matrix.'
- lang: es
  value: "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: s390/vfio-ap:\
    \ filtra siempre toda la matriz AP La funci\xF3n vfio_ap_mdev_filter_matrix se\
    \ llama cada vez que se asigna un nuevo adaptador o dominio al mdev. El prop\xF3\
    sito de la funci\xF3n es actualizar la configuraci\xF3n del AP del invitado filtrando\
    \ la matriz de adaptadores y dominios asignados al mdev. Cuando se asigna un adaptador\
    \ o dominio, solo se inspeccionan los APQN asociados con el APID del nuevo adaptador\
    \ o APQI del nuevo dominio. Si un APQN no hace referencia a un dispositivo de\
    \ cola vinculado al controlador de dispositivo vfio_ap, entonces su APID se filtrar\xE1\
    \ de la matriz de mdev al actualizar la configuraci\xF3n de AP del invitado. Inspeccionar\
    \ solo el APID del nuevo adaptador o APQI del nuevo dominio dar\xE1 como resultado\
    \ que se pasen colas de AP a un invitado que no est\xE1 vinculado al controlador\
    \ de dispositivo vfio_ap en determinadas circunstancias. Considere lo siguiente:\
    \ configuraci\xF3n de AP del invitado (todas tambi\xE9n asignadas a la matriz\
    \ de mdev): 14.0004 14.0005 14.0006 16.0004 16.0005 16.0006 desasignar dominio\
    \ 4 desvincular cola 16.0005 asignar dominio 4 Cuando se reasigna el dominio 4,\
    \ dado que solo se inspeccionar\xE1 el dominio 4, los APQN que se examinar\xE1\
    \ ser\xE1: 14.0004 16.0004 Dado que ambos APQN hacen referencia a dispositivos\
    \ de cola que est\xE1n vinculados al controlador de dispositivo vfio_ap, no se\
    \ filtrar\xE1 nada de la matriz de mdev al actualizar la configuraci\xF3n de AP\
    \ del invitado. En consecuencia, la cola 16.0005 pasar\xE1 a pesar de no estar\
    \ vinculada al conductor. Esto viola el requisito del modelo de dispositivo Linux\
    \ de que a un invitado solo se le dar\xE1 acceso a los dispositivos vinculados\
    \ al controlador del dispositivo que facilita su paso. Para resolver este problema,\
    \ cada adaptador y dominio asignado al mdev se inspeccionar\xE1 al filtrar la\
    \ matriz del mdev."
id: CVE-2024-26620
lastModified: '2024-03-12T12:40:13.500'
metrics: {}
published: '2024-03-11T18:15:19.613'
references:
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/850fb7fa8c684a4c6bf0e4b6978f4ddcc5d43d11
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/c69d821197611678533fb3eb784fc823b921349a
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/cdd134d56138302976685e6c7bc4755450b3880e
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/d6b8d034b576f406af920a7bee81606c027b24c6
sourceIdentifier: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
vulnStatus: Awaiting Analysis
