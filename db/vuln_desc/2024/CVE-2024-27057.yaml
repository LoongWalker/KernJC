cveTags: []
descriptions:
- lang: en
  value: 'In the Linux kernel, the following vulnerability has been resolved:


    ASoC: SOF: ipc4-pcm: Workaround for crashed firmware on system suspend


    When the system is suspended while audio is active, the

    sof_ipc4_pcm_hw_free() is invoked to reset the pipelines since during

    suspend the DSP is turned off, streams will be re-started after resume.


    If the firmware crashes during while audio is running (or when we reset

    the stream before suspend) then the sof_ipc4_set_multi_pipeline_state()

    will fail with IPC error and the state change is interrupted.

    This will cause misalignment between the kernel and firmware state on next

    DSP boot resulting errors returned by firmware for IPC messages, eventually

    failing the audio resume.

    On stream close the errors are ignored so the kernel state will be

    corrected on the next DSP boot, so the second boot after the DSP panic.


    If sof_ipc4_trigger_pipelines() is called from sof_ipc4_pcm_hw_free() then

    state parameter is SOF_IPC4_PIPE_RESET and only in this case.


    Treat a forced pipeline reset similarly to how we treat a pcm_free by

    ignoring error on state sending to allow the kernel''s state to be

    consistent with the state the firmware will have after the next boot.'
- lang: es
  value: "En el kernel de Linux, se resolvi\xF3 la siguiente vulnerabilidad: ASoC:\
    \ SOF: ipc4-pcm: workaround para firmware bloqueado en suspensi\xF3n del sistema\
    \ Cuando el sistema se suspende mientras el audio est\xE1 activo, se invoca sof_ipc4_pcm_hw_free()\
    \ para restablecer las canalizaciones desde durante la suspensi\xF3n el DSP est\xE1\
    \ apagado, las transmisiones se reiniciar\xE1n despu\xE9s de reanudarse. Si el\
    \ firmware falla mientras se ejecuta el audio (o cuando reiniciamos la transmisi\xF3\
    n antes de suspenderla), entonces sof_ipc4_set_multi_pipeline_state() fallar\xE1\
    \ con un error de IPC y se interrumpir\xE1 el cambio de estado. Esto provocar\xE1\
    \ una desalineaci\xF3n entre el estado del kernel y del firmware en el siguiente\
    \ arranque del DSP, lo que provocar\xE1 errores devueltos por el firmware para\
    \ los mensajes IPC, lo que eventualmente provocar\xE1 un error en la reanudaci\xF3\
    n del audio. Al cerrar la transmisi\xF3n, los errores se ignoran, por lo que el\
    \ estado del kernel se corregir\xE1 en el siguiente inicio del DSP, es decir,\
    \ en el segundo inicio despu\xE9s del p\xE1nico del DSP. Si se llama a sof_ipc4_trigger_pipelines()\
    \ desde sof_ipc4_pcm_hw_free() entonces el par\xE1metro de estado es SOF_IPC4_PIPE_RESET\
    \ y solo en este caso. Trate un reinicio forzado de canalizaci\xF3n de manera\
    \ similar a como tratamos un pcm_free ignorando el error en el env\xEDo del estado\
    \ para permitir que el estado del kernel sea consistente con el estado que tendr\xE1\
    \ el firmware despu\xE9s del siguiente arranque."
id: CVE-2024-27057
lastModified: '2024-05-01T19:50:25.633'
metrics: {}
published: '2024-05-01T13:15:50.400'
references:
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/3cac6eebea9b4bc5f041e157e45c76e212ad6759
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/c40aad7c81e5fba34b70123ed7ce3397fa62a4d2
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/d153e8b154f9746ac969c85a4e6474760453647c
sourceIdentifier: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
vulnStatus: Awaiting Analysis
