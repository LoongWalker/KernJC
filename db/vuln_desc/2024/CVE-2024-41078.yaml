cveTags: []
descriptions:
- lang: en
  value: 'In the Linux kernel, the following vulnerability has been resolved:


    btrfs: qgroup: fix quota root leak after quota disable failure


    If during the quota disable we fail when cleaning the quota tree or when

    deleting the root from the root tree, we jump to the ''out'' label without

    ever dropping the reference on the quota root, resulting in a leak of the

    root since fs_info->quota_root is no longer pointing to the root (we have

    set it to NULL just before those steps).


    Fix this by always doing a btrfs_put_root() call under the ''out'' label.

    This is a problem that exists since qgroups were first added in 2012 by

    commit bed92eae26cc ("Btrfs: qgroup implementation and prototypes"), but

    back then we missed a kfree on the quota root and free_extent_buffer()

    calls on its root and commit root nodes, since back then roots were not

    yet reference counted.'
- lang: es
  value: "En el kernel de Linux se ha solucionado la siguiente vulnerabilidad: btrfs:qgroup:\
    \ arregla fuga de cuota ra\xEDz tras fallo de desactivaci\xF3n de cuota Si durante\
    \ la desactivaci\xF3n de cuota fallamos al limpiar el \xE1rbol de cuotas o al\
    \ borrar el root del \xE1rbol ra\xEDz, saltamos al etiqueta 'out' sin eliminar\
    \ la referencia en la ra\xEDz de la cuota, lo que resulta en una p\xE9rdida de\
    \ la ra\xEDz ya que fs_info-&gt;quota_root ya no apunta a la ra\xEDz (la hemos\
    \ configurado en NULL justo antes de esos pasos). Solucione este problema realizando\
    \ siempre una llamada btrfs_put_root() bajo la etiqueta 'out'. Este es un problema\
    \ que existe desde que qgroups se agregaron por primera vez en 2012 mediante el\
    \ compromiso bed92eae26cc (\"Btrfs: implementaci\xF3n y prototipos de qgroup\"\
    ), pero en aquel entonces nos perdimos un kfree en la cuota ra\xEDz y llamadas\
    \ free_extent_buffer() en su ra\xEDz y en los nodos ra\xEDz de confirmaci\xF3\
    n. , ya que en aquel entonces las ra\xEDces a\xFAn no se contaban como referencia."
id: CVE-2024-41078
lastModified: '2024-07-29T16:21:52.517'
metrics: {}
published: '2024-07-29T15:15:15.380'
references:
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/5ef3961682e5310f2221bae99bcf9f5d0f4b0d51
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/7dd6a5b96157a21245566b21fd58276a214357ff
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/8a69529f22590b67bb018de9acbcf94abc8603cf
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/94818bdb00ef34a996a06aa63d11f591074cb757
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/a7e4c6a3031c74078dba7fa36239d0f4fe476c53
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/f88aeff5a173e8ba3133314eb4b964236ef3589d
sourceIdentifier: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
vulnStatus: Awaiting Analysis
