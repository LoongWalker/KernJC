cveTags: []
descriptions:
- lang: en
  value: 'In the Linux kernel, the following vulnerability has been resolved:


    cachefiles: flush all requests after setting CACHEFILES_DEAD


    In ondemand mode, when the daemon is processing an open request, if the

    kernel flags the cache as CACHEFILES_DEAD, the cachefiles_daemon_write()

    will always return -EIO, so the daemon can''t pass the copen to the kernel.

    Then the kernel process that is waiting for the copen triggers a hung_task.


    Since the DEAD state is irreversible, it can only be exited by closing

    /dev/cachefiles. Therefore, after calling cachefiles_io_error() to mark

    the cache as CACHEFILES_DEAD, if in ondemand mode, flush all requests to

    avoid the above hungtask. We may still be able to read some of the cached

    data before closing the fd of /dev/cachefiles.


    Note that this relies on the patch that adds reference counting to the req,

    otherwise it may UAF.'
- lang: es
  value: "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: cachefiles:\
    \ vac\xEDa todas las solicitudes despu\xE9s de configurar CACHEFILES_DEAD En modo\
    \ bajo demanda, cuando el daemon est\xE1 procesando una solicitud abierta, si\
    \ el kernel marca el cach\xE9 como CACHEFILES_DEAD, cachefiles_daemon_write()\
    \ siempre devolver\xE1: EIO, por lo que el daemon no puede pasar el copen al kernel.\
    \ Luego, el proceso del n\xFAcleo que est\xE1 esperando el copen activa una tarea\
    \ colgada. Dado que el estado DEAD es irreversible, solo se puede salir cerrando\
    \ /dev/cachefiles. Por lo tanto, despu\xE9s de llamar a cachefiles_io_error()\
    \ para marcar el cach\xE9 como CACHEFILES_DEAD, si est\xE1 en modo bajo demanda,\
    \ vac\xEDe todas las solicitudes para evitar la tarea suspendida anterior. Es\
    \ posible que a\xFAn podamos leer algunos de los datos almacenados en cach\xE9\
    \ antes de cerrar el fd de /dev/cachefiles. Tenga en cuenta que esto depende del\
    \ parche que agrega el recuento de referencias al requisito; de lo contrario,\
    \ puede ser UAF."
id: CVE-2024-40935
lastModified: '2024-07-12T16:34:58.687'
metrics: {}
published: '2024-07-12T13:15:16.053'
references:
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/320ba9cbca78be79c912143bbba1d1b35ca55cf0
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/3bf0b8030296e9ee60d3d4c15849ad9ac0b47081
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/85e833cd7243bda7285492b0653c3abb1e2e757b
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/e73fac95084839c5178d97e81c6a2051251bdc00
sourceIdentifier: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
vulnStatus: Awaiting Analysis
