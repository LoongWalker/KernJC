descriptions:
- lang: en
  value: 'In the Linux kernel, the following vulnerability has been resolved:


    dma-direct: Leak pages on dma_set_decrypted() failure


    On TDX it is possible for the untrusted host to cause

    set_memory_encrypted() or set_memory_decrypted() to fail such that an

    error is returned and the resulting memory is shared. Callers need to

    take care to handle these errors to avoid returning decrypted (shared)

    memory to the page allocator, which could lead to functional or security

    issues.


    DMA could free decrypted/shared pages if dma_set_decrypted() fails. This

    should be a rare case. Just leak the pages in this case instead of

    freeing them.'
- lang: es
  value: " En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: dma-direct:\
    \ p\xE1ginas filtradas en el fallo de dma_set_decrypted() En TDX es posible que\
    \ el host que no es de confianza provoque que set_memory_encrypted() o set_memory_decrypted()\
    \ falle de modo que se devuelva un error y la memoria resultante se comparte.\
    \ Las personas que llaman deben tener cuidado al manejar estos errores para evitar\
    \ devolver memoria descifrada (compartida) al asignador de p\xE1ginas, lo que\
    \ podr\xEDa provocar problemas funcionales o de seguridad. DMA podr\xEDa liberar\
    \ p\xE1ginas descifradas/compartidas si dma_set_decrypted() falla. Este deber\xED\
    a ser un caso raro. En este caso, simplemente filtre las p\xE1ginas en lugar de\
    \ liberarlas."
id: CVE-2024-35939
lastModified: '2024-05-20T13:00:04.957'
metrics: {}
published: '2024-05-19T11:15:49.690'
references:
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/4031b72ca747a1e6e9ae4fa729e765b43363d66a
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/4e0cfb25d49da2e6261ad582f58ffa5b5dd8c8e9
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/b57326c96b7bc7638aa8c44e12afa2defe0c934c
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/b9fa16949d18e06bdf728a560f5c8af56d2bdcaf
sourceIdentifier: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
vulnStatus: Awaiting Analysis
