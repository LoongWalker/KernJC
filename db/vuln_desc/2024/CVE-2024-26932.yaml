configurations:
- nodes:
  - cpeMatch:
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 1649B701-9DF9-4E5D-AA4B-6A7071BF05D6
      versionEndExcluding: 6.8.3
      versionStartExcluding: '6.8'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:6.9:rc1:*:*:*:*:*:*
      matchCriteriaId: 22BEDD49-2C6D-402D-9DBF-6646F6ECD10B
      vulnerable: true
    negate: false
    operator: OR
descriptions:
- lang: en
  value: 'In the Linux kernel, the following vulnerability has been resolved:


    usb: typec: tcpm: fix double-free issue in tcpm_port_unregister_pd()


    When unregister pd capabilitie in tcpm, KASAN will capture below double

    -free issue. The root cause is the same capabilitiy will be kfreed twice,

    the first time is kfreed by pd_capabilities_release() and the second time

    is explicitly kfreed by tcpm_port_unregister_pd().


    [    3.988059] BUG: KASAN: double-free in tcpm_port_unregister_pd+0x1a4/0x3dc

    [    3.995001] Free of addr ffff0008164d3000 by task kworker/u16:0/10

    [    4.001206]

    [    4.002712] CPU: 2 PID: 10 Comm: kworker/u16:0 Not tainted 6.8.0-rc5-next-20240220-05616-g52728c567a55
    #53

    [    4.012402] Hardware name: Freescale i.MX8QXP MEK (DT)

    [    4.017569] Workqueue: events_unbound deferred_probe_work_func

    [    4.023456] Call trace:

    [    4.025920]  dump_backtrace+0x94/0xec

    [    4.029629]  show_stack+0x18/0x24

    [    4.032974]  dump_stack_lvl+0x78/0x90

    [    4.036675]  print_report+0xfc/0x5c0

    [    4.040289]  kasan_report_invalid_free+0xa0/0xc0

    [    4.044937]  __kasan_slab_free+0x124/0x154

    [    4.049072]  kfree+0xb4/0x1e8

    [    4.052069]  tcpm_port_unregister_pd+0x1a4/0x3dc

    [    4.056725]  tcpm_register_port+0x1dd0/0x2558

    [    4.061121]  tcpci_register_port+0x420/0x71c

    [    4.065430]  tcpci_probe+0x118/0x2e0


    To fix the issue, this will remove kree() from tcpm_port_unregister_pd().'
- lang: es
  value: "En el kernel de Linux, se resolvi\xF3 la siguiente vulnerabilidad: usb:\
    \ typec: tcpm: soluciona el problema de doble liberaci\xF3n en tcpm_port_unregister_pd()\
    \ Cuando se cancela el registro de la capacidad de pd en tcpm, KASAN capturar\xE1\
    \ el siguiente problema de doble liberaci\xF3n. La causa principal es que la misma\
    \ capacidad se liberar\xE1 dos veces, la primera vez se liberar\xE1 mediante pd_capabilities_release()\
    \ y la segunda vez se liberar\xE1 expl\xEDcitamente mediante tcpm_port_unregister_pd().\
    \ [3.988059] ERROR: KASAN: doble liberaci\xF3n en tcpm_port_unregister_pd+0x1a4/0x3dc\
    \ [3.995001] Libre de direcci\xF3n ffff0008164d3000 por tarea kworker/u16:0/10\
    \ [4.001206] [4.002712] CPU: 2 PID: 10 Co mm: ktrabajador/u16: 0 No contaminado\
    \ 6.8.0-rc5-next-20240220-05616-g52728c567a55 #53 [4.012402] Nombre del hardware:\
    \ Freescale i.MX8QXP MEK (DT) [4.017569] Cola de trabajo: events_unbound deferred_probe_work_func\
    \ [4.023456] Seguimiento de llamadas: [ 4.025920] dump_backtrace+ 0x94/0xec [\
    \ 4.029629] show_stack+0x18/0x24 [ 4.032974] dump_stack_lvl+0x78/0x90 [ 4.036675]\
    \ print_report+0xfc/0x5c0 [ 4.040289] kasan_report_invalid_free+0xa0/0xc0 [ 4\
    \ .044937] __kasan_slab_free+0x124/0x154 [ 4.049072] kfree+0xb4/ 0x1e8 [ 4.052069]\
    \ tcpm_port_unregister_pd+0x1a4/0x3dc [ 4.056725] tcpm_register_port+0x1dd0/0x2558\
    \ [ 4.061121] tcpci_register_port+0x420/0x71c [ 4.065430] +0x118/0x2e0 Para solucionar\
    \ el problema, esto eliminar\xE1 kree() de tcpm_port_unregister_pd()."
id: CVE-2024-26932
lastModified: '2024-05-23T19:12:39.257'
metrics:
  cvssMetricV31:
  - cvssData:
      attackComplexity: LOW
      attackVector: LOCAL
      availabilityImpact: HIGH
      baseScore: 7.8
      baseSeverity: HIGH
      confidentialityImpact: HIGH
      integrityImpact: HIGH
      privilegesRequired: LOW
      scope: UNCHANGED
      userInteraction: NONE
      vectorString: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
      version: '3.1'
    exploitabilityScore: 1.8
    impactScore: 5.9
    source: nvd@nist.gov
    type: Primary
published: '2024-05-01T06:15:07.810'
references:
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/242e425ed580b2f4dbcb86c8fc03a410a4084a69
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/b63f90487bdf93a4223ce7853d14717e9d452856
sourceIdentifier: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
vulnStatus: Analyzed
weaknesses:
- description:
  - lang: en
    value: CWE-415
  source: nvd@nist.gov
  type: Primary
