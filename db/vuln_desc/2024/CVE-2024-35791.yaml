descriptions:
- lang: en
  value: 'In the Linux kernel, the following vulnerability has been resolved:


    KVM: SVM: Flush pages under kvm->lock to fix UAF in svm_register_enc_region()


    Do the cache flush of converted pages in svm_register_enc_region() before

    dropping kvm->lock to fix use-after-free issues where region and/or its

    array of pages could be freed by a different task, e.g. if userspace has

    __unregister_enc_region_locked() already queued up for the region.


    Note, the "obvious" alternative of using local variables doesn''t fully

    resolve the bug, as region->pages is also dynamically allocated.  I.e. the

    region structure itself would be fine, but region->pages could be freed.


    Flushing multiple pages under kvm->lock is unfortunate, but the entire

    flow is a rare slow path, and the manual flush is only needed on CPUs that

    lack coherency for encrypted memory.'
- lang: es
  value: "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: KVM:\
    \ SVM: Vaciar p\xE1ginas bajo kvm-&gt;lock para arreglar UAF en svm_register_enc_region()\
    \ Realice el vaciado de cach\xE9 de las p\xE1ginas convertidas en svm_register_enc_region()\
    \ antes de eliminar kvm-&gt;lock para arreglar el uso -Problemas posteriores a\
    \ la liberaci\xF3n en los que la regi\xF3n y/o su conjunto de p\xE1ginas podr\xED\
    an liberarse mediante una tarea diferente, por ejemplo, si el espacio de usuario\
    \ ya tiene __unregister_enc_region_locked() en cola para la regi\xF3n. Tenga en\
    \ cuenta que la alternativa \"obvia\" de usar variables locales no resuelve completamente\
    \ el error, ya que regi\xF3n-&gt;p\xE1ginas tambi\xE9n se asigna din\xE1micamente.\
    \ Es decir, la estructura de la regi\xF3n en s\xED estar\xEDa bien, pero se podr\xED\
    an liberar regiones-&gt;p\xE1ginas. Vaciar varias p\xE1ginas bajo kvm-&gt;lock\
    \ es desafortunado, pero todo el flujo es un camino lento poco com\xFAn, y el\
    \ vaciado manual solo es necesario en CPU que carecen de coherencia para la memoria\
    \ cifrada."
id: CVE-2024-35791
lastModified: '2024-06-25T22:15:30.563'
metrics: {}
published: '2024-05-17T13:15:58.873'
references:
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/12f8e32a5a389a5d58afc67728c76e61beee1ad4
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/2d13b79640b147bd77c34a5998533b2021a4122d
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/4868c0ecdb6cfde7c70cf478c46e06bb9c7e5865
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/5ef1d8c1ddbf696e47b226e11888eaf8d9e8e807
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/e126b508ed2e616d679d85fca2fbe77bb48bbdd7
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/f6d53d8a2617dd58c89171a6b9610c470ebda38a
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://lists.debian.org/debian-lts-announce/2024/06/msg00017.html
sourceIdentifier: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
vulnStatus: Awaiting Analysis
