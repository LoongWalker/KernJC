configurations:
- nodes:
  - cpeMatch:
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 6F1F2625-29D5-4FED-B7F5-6087227ABCB3
      versionEndExcluding: 6.1.84
      versionStartIncluding: 4.16.0
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: A5CC150E-F35C-4CF7-ADF5-422D32C511C2
      versionEndExcluding: 6.6.18
      versionStartIncluding: 6.2.0
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 0C8D1FAD-4D5D-4A25-B058-2AD15082710E
      versionEndExcluding: 6.7.6
      versionStartIncluding: 6.7.0
      vulnerable: true
    negate: false
    operator: OR
cveTags: []
descriptions:
- lang: en
  value: "In the Linux kernel, the following vulnerability has been resolved:\n\n\
    net: tls: handle backlogging of crypto requests\n\nSince we're setting the CRYPTO_TFM_REQ_MAY_BACKLOG\
    \ flag on our\nrequests to the crypto API, crypto_aead_{encrypt,decrypt} can return\n\
    \ -EBUSY instead of -EINPROGRESS in valid situations. For example, when\nthe cryptd\
    \ queue for AESNI is full (easy to trigger with an\nartificially low cryptd.cryptd_max_cpu_qlen),\
    \ requests will be enqueued\nto the backlog but still processed. In that case,\
    \ the async callback\nwill also be called twice: first with err == -EINPROGRESS,\
    \ which it\nseems we can just ignore, then with err == 0.\n\nCompared to Sabrina's\
    \ original patch this version uses the new\ntls_*crypt_async_wait() helpers and\
    \ converts the EBUSY to\nEINPROGRESS to avoid having to modify all the error handling\n\
    paths. The handling is identical."
- lang: es
  value: "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: net:\
    \ tls: manejar el retraso de solicitudes criptogr\xE1ficas Dado que estamos configurando\
    \ el indicador CRYPTO_TFM_REQ_MAY_BACKLOG en nuestras solicitudes a la API criptogr\xE1\
    fica, crypto_aead_{encrypt,decrypt} puede devolver -EBUSY en lugar de - EINPROGRESS\
    \ en situaciones v\xE1lidas. Por ejemplo, cuando la cola cryptd para AESNI est\xE1\
    \ llena (f\xE1cil de activar con un cryptd.cryptd_max_cpu_qlen artificialmente\
    \ bajo), las solicitudes se pondr\xE1n en cola en el trabajo pendiente, pero a\xFA\
    n as\xED se procesar\xE1n. En ese caso, la devoluci\xF3n de llamada as\xEDncrona\
    \ tambi\xE9n se llamar\xE1 dos veces: primero con err == -EINPROGRESS, que parece\
    \ que podemos ignorar, luego con err == 0. En comparaci\xF3n con el parche original\
    \ de Sabrina, esta versi\xF3n usa el nuevo tls_*crypt_async_wait( ) ayuda y convierte\
    \ EBUSY a EINPROGRESS para evitar tener que modificar todas las rutas de manejo\
    \ de errores. El manejo es id\xE9ntico."
id: CVE-2024-26584
lastModified: '2024-05-25T15:15:08.847'
metrics:
  cvssMetricV31:
  - cvssData:
      attackComplexity: LOW
      attackVector: LOCAL
      availabilityImpact: HIGH
      baseScore: 5.5
      baseSeverity: MEDIUM
      confidentialityImpact: NONE
      integrityImpact: NONE
      privilegesRequired: LOW
      scope: UNCHANGED
      userInteraction: NONE
      vectorString: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
      version: '3.1'
    exploitabilityScore: 1.8
    impactScore: 3.6
    source: nvd@nist.gov
    type: Primary
published: '2024-02-21T15:15:09.420'
references:
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/13eca403876bbea3716e82cdfe6f1e6febb38754
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/3ade391adc584f17b5570fd205de3ad029090368
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/8590541473188741055d27b955db0777569438e3
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/ab6397f072e5097f267abf5cb08a8004e6b17694
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/cd1bbca03f3c1d845ce274c0d0a66de8e5929f72
sourceIdentifier: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
vulnStatus: Modified
weaknesses:
- description:
  - lang: en
    value: CWE-755
  source: nvd@nist.gov
  type: Primary
