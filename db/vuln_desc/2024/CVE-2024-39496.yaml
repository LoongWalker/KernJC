configurations:
- nodes:
  - cpeMatch:
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 19A7A2F1-5F51-4897-8BF3-5079D28CBE9C
      versionEndExcluding: 6.1.95
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 6F019D15-84C0-416B-8C57-7F51B68992F0
      versionEndExcluding: 6.6.35
      versionStartIncluding: '6.2'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 0ABBBA1D-F79D-4BDB-AA41-D1EDCC4A6975
      versionEndExcluding: 6.9.6
      versionStartIncluding: '6.7'
      vulnerable: true
    negate: false
    operator: OR
cveTags: []
descriptions:
- lang: en
  value: 'In the Linux kernel, the following vulnerability has been resolved:


    btrfs: zoned: fix use-after-free due to race with dev replace


    While loading a zone''s info during creation of a block group, we can race

    with a device replace operation and then trigger a use-after-free on the

    device that was just replaced (source device of the replace operation).


    This happens because at btrfs_load_zone_info() we extract a device from

    the chunk map into a local variable and then use the device while not

    under the protection of the device replace rwsem. So if there''s a device

    replace operation happening when we extract the device and that device

    is the source of the replace operation, we will trigger a use-after-free

    if before we finish using the device the replace operation finishes and

    frees the device.


    Fix this by enlarging the critical section under the protection of the

    device replace rwsem so that all uses of the device are done inside the

    critical section.'
- lang: es
  value: "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: btrfs:zoned:\
    \ corrige el use-after-free debido a la ejecuci\xF3n con el reemplazo de desarrollo.\
    \ Mientras cargamos la informaci\xF3n de una zona durante la creaci\xF3n de un\
    \ grupo de bloques, podemos ejecutar una operaci\xF3n de reemplazo de dispositivo\
    \ y luego activar un use-after-free en el dispositivo que acaba de ser reemplazado\
    \ (dispositivo fuente de la operaci\xF3n de reemplazo). Esto sucede porque en\
    \ btrfs_load_zone_info() extraemos un dispositivo del mapa de fragmentos en una\
    \ variable local y luego usamos el dispositivo mientras no est\xE1 bajo la protecci\xF3\
    n del dispositivo y reemplazamos rwsem. Entonces, si se produce una operaci\xF3\
    n de reemplazo de dispositivo cuando extraemos el dispositivo y ese dispositivo\
    \ es la fuente de la operaci\xF3n de reemplazo, activaremos un use-after-free\
    \ si antes de terminar de usar el dispositivo la operaci\xF3n de reemplazo finaliza\
    \ y libera el dispositivo. Solucione este problema ampliando la secci\xF3n cr\xED\
    tica bajo la protecci\xF3n del dispositivo y reemplace rwsem para que todos los\
    \ usos del dispositivo se realicen dentro de la secci\xF3n cr\xEDtica."
id: CVE-2024-39496
lastModified: '2024-07-24T19:02:36.660'
metrics:
  cvssMetricV31:
  - cvssData:
      attackComplexity: LOW
      attackVector: LOCAL
      availabilityImpact: HIGH
      baseScore: 7.8
      baseSeverity: HIGH
      confidentialityImpact: HIGH
      integrityImpact: HIGH
      privilegesRequired: LOW
      scope: UNCHANGED
      userInteraction: NONE
      vectorString: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
      version: '3.1'
    exploitabilityScore: 1.8
    impactScore: 5.9
    source: nvd@nist.gov
    type: Primary
published: '2024-07-12T13:15:12.253'
references:
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/0090d6e1b210551e63cf43958dc7a1ec942cdde9
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/092571ef9a812566c8f2c9038d9c2a64c49788d6
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/17765964703b88d8befd899f8501150bb7e07e43
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/a0cc006f4214b87e70983c692e05bb36c59b5752
sourceIdentifier: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
vulnStatus: Analyzed
weaknesses:
- description:
  - lang: en
    value: CWE-416
  source: nvd@nist.gov
  type: Primary
