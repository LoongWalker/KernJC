descriptions:
- lang: en
  value: 'In the Linux kernel, the following vulnerability has been resolved:


    wifi: ath9k: delay all of ath9k_wmi_event_tasklet() until init is complete


    The ath9k_wmi_event_tasklet() used in ath9k_htc assumes that all the data

    structures have been fully initialised by the time it runs. However, because of

    the order in which things are initialised, this is not guaranteed to be the

    case, because the device is exposed to the USB subsystem before the ath9k driver

    initialisation is completed.


    We already committed a partial fix for this in commit:

    8b3046abc99e ("ath9k_htc: fix NULL pointer dereference at ath9k_htc_tx_get_packet()")


    However, that commit only aborted the WMI_TXSTATUS_EVENTID command in the event

    tasklet, pairing it with an "initialisation complete" bit in the TX struct. It

    seems syzbot managed to trigger the race for one of the other commands as well,

    so let''s just move the existing synchronisation bit to cover the whole

    tasklet (setting it at the end of ath9k_htc_probe_device() instead of inside

    ath9k_tx_init()).'
- lang: es
  value: "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: wifi:\
    \ ath9k: retrasa todo ath9k_wmi_event_tasklet() hasta que se complete el inicio.\
    \ El ath9k_wmi_event_tasklet() usado en ath9k_htc supone que todas las estructuras\
    \ de datos se han inicializado por completo en el momento de su ejecuci\xF3n.\
    \ Sin embargo, debido al orden en que se inicializan las cosas, no se garantiza\
    \ que este sea el caso, porque el dispositivo queda expuesto al subsistema USB\
    \ antes de que se complete la inicializaci\xF3n del controlador ath9k. Ya cometimos\
    \ una soluci\xF3n parcial para esto en la confirmaci\xF3n: 8b3046abc99e (\"ath9k_htc:\
    \ corrige la desreferencia del puntero NULL en ath9k_htc_tx_get_packet()\") Sin\
    \ embargo, esa confirmaci\xF3n solo abort\xF3 el comando WMI_TXSTATUS_EVENTID\
    \ en el tasklet de eventos, emparej\xE1ndolo con un bit de \"inicializaci\xF3\
    n completa\" en la estructura TX. Parece que syzbot tambi\xE9n logr\xF3 activar\
    \ la carrera para uno de los otros comandos, as\xED que simplemente movamos el\
    \ bit de sincronizaci\xF3n existente para cubrir todo el tasklet (configur\xE1\
    ndolo al final de ath9k_htc_probe_device() en lugar de dentro de ath9k_tx_init())."
id: CVE-2024-26897
lastModified: '2024-06-25T23:15:27.180'
metrics: {}
published: '2024-04-17T11:15:10.773'
references:
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/1bc5461a21c56a36e2a7d81e152b90ce019a3905
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/24355fcb0d4cbcb6ddda262596558e8cfba70f11
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/4afa0246656d5680c8a4c3fb37ba6570c4ab819b
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/74d0639261dd795dce958d1b14815bdcbb48a715
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/a015fbf698c8957aa5fbeefc5c59dd2cf3107298
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/ac90e22e735bac44f74b5161fb096fbeb0ff8bc2
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/f8ff4b4df71e87f609be0cc37d92e918107f9b90
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://lists.debian.org/debian-lts-announce/2024/06/msg00017.html
sourceIdentifier: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
vulnStatus: Awaiting Analysis
