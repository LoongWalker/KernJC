cveTags: []
descriptions:
- lang: en
  value: 'In the Linux kernel, the following vulnerability has been resolved:


    cachefiles: defer exposing anon_fd until after copy_to_user() succeeds


    After installing the anonymous fd, we can now see it in userland and close

    it. However, at this point we may not have gotten the reference count of

    the cache, but we will put it during colse fd, so this may cause a cache

    UAF.


    So grab the cache reference count before fd_install(). In addition, by

    kernel convention, fd is taken over by the user land after fd_install(),

    and the kernel should not call close_fd() after that, i.e., it should call

    fd_install() after everything is ready, thus fd_install() is called after

    copy_to_user() succeeds.'
- lang: es
  value: "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: cachefiles:\
    \ difiere la exposici\xF3n de anon_fd hasta que copy_to_user() tenga \xE9xito.\
    \ Despu\xE9s de instalar el fd an\xF3nimo, ahora podemos verlo en el \xE1rea de\
    \ usuario y cerrarlo. Sin embargo, en este punto es posible que no hayamos obtenido\
    \ el recuento de referencias del cach\xE9, pero lo colocaremos durante colse fd,\
    \ por lo que esto puede causar un UAF de cach\xE9. As\xED que tome el recuento\
    \ de referencias de cach\xE9 antes de fd_install(). Adem\xE1s, seg\xFAn la convenci\xF3\
    n del kernel, el usuario se hace cargo de fd despu\xE9s de fd_install(), y el\
    \ kernel no debe llamar a close_fd() despu\xE9s de eso, es decir, debe llamar\
    \ a fd_install() despu\xE9s de que todo est\xE9 listo, por lo que fd_install()\
    \ es llamado despu\xE9s de que copy_to_user() tenga \xE9xito."
id: CVE-2024-40913
lastModified: '2024-07-12T16:34:58.687'
metrics: {}
published: '2024-07-12T13:15:14.457'
references:
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/4b4391e77a6bf24cba2ef1590e113d9b73b11039
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/b9f58cdae6a364a3270fd6b6a46e0fd4f7f8ce32
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/d2d3eb377a5d081bf2bed177d354a4f59b74da88
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/eac51d9daacd61dcc93333ff6a890cf3efc8c1c0
sourceIdentifier: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
vulnStatus: Awaiting Analysis
