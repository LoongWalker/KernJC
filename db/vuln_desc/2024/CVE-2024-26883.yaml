configurations:
- nodes:
  - cpeMatch:
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: A6E19FC1-2A3F-4FF8-805C-2864C71553EC
      versionEndExcluding: 4.19.311
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 620FD8B7-BF03-43E0-951A-0A58461D4C55
      versionEndExcluding: 5.4.273
      versionStartIncluding: '4.20'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 65987874-467B-4D3B-91D6-68A129B34FB8
      versionEndExcluding: 5.10.214
      versionStartIncluding: '5.5'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: ACB69438-845D-4E3C-B114-3140611F9C0B
      versionEndExcluding: 5.15.153
      versionStartIncluding: '5.11'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 121A07F6-F505-4C47-86BF-9BB6CC7B6C19
      versionEndExcluding: 6.1.83
      versionStartIncluding: '5.16'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: E00814DC-0BA7-431A-9926-80FEB4A96C68
      versionEndExcluding: 6.6.23
      versionStartIncluding: '6.2'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 9B95D3A6-E162-47D5-ABFC-F3FA74FA7CFD
      versionEndExcluding: 6.7.11
      versionStartIncluding: '6.7'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 543A75FF-25B8-4046-A514-1EA8EDD87AB1
      versionEndExcluding: 6.8.2
      versionStartIncluding: '6.8'
      vulnerable: true
    negate: false
    operator: OR
descriptions:
- lang: en
  value: 'In the Linux kernel, the following vulnerability has been resolved:


    bpf: Fix stackmap overflow check on 32-bit arches


    The stackmap code relies on roundup_pow_of_two() to compute the number

    of hash buckets, and contains an overflow check by checking if the

    resulting value is 0. However, on 32-bit arches, the roundup code itself

    can overflow by doing a 32-bit left-shift of an unsigned long value,

    which is undefined behaviour, so it is not guaranteed to truncate

    neatly. This was triggered by syzbot on the DEVMAP_HASH type, which

    contains the same check, copied from the hashtab code.


    The commit in the fixes tag actually attempted to fix this, but the fix

    did not account for the UB, so the fix only works on CPUs where an

    overflow does result in a neat truncation to zero, which is not

    guaranteed. Checking the value before rounding does not have this

    problem.'
- lang: es
  value: "En el kernel de Linux, se resolvi\xF3 la siguiente vulnerabilidad: bpf:\
    \ corrige la verificaci\xF3n de desbordamiento del mapa de pila en arcos de 32\
    \ bits. El c\xF3digo del mapa de pila se basa en roundup_pow_of_two() para calcular\
    \ el n\xFAmero de dep\xF3sitos de hash y contiene una verificaci\xF3n de desbordamiento\
    \ verificando si el valor resultante es 0. Sin embargo, en arcos de 32 bits, el\
    \ c\xF3digo de resumen en s\xED puede desbordarse al realizar un desplazamiento\
    \ hacia la izquierda de 32 bits de un valor largo sin signo, lo cual es un comportamiento\
    \ indefinido, por lo que no se garantiza que se trunque claramente. Esto fue activado\
    \ por syzbot en el tipo DEVMAP_HASH, que contiene la misma verificaci\xF3n, copiada\
    \ del c\xF3digo hashtab. La confirmaci\xF3n en la etiqueta de correcciones en\
    \ realidad intent\xF3 solucionar este problema, pero la correcci\xF3n no tuvo\
    \ en cuenta la UB, por lo que la correcci\xF3n solo funciona en CPU donde un desbordamiento\
    \ resulta en un truncamiento claro a cero, lo cual no est\xE1 garantizado. Verificar\
    \ el valor antes de redondear no tiene este problema."
id: CVE-2024-26883
lastModified: '2024-06-25T22:15:24.943'
metrics:
  cvssMetricV31:
  - cvssData:
      attackComplexity: LOW
      attackVector: LOCAL
      availabilityImpact: HIGH
      baseScore: 7.8
      baseSeverity: HIGH
      confidentialityImpact: HIGH
      integrityImpact: HIGH
      privilegesRequired: LOW
      scope: UNCHANGED
      userInteraction: NONE
      vectorString: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
      version: '3.1'
    exploitabilityScore: 1.8
    impactScore: 5.9
    source: nvd@nist.gov
    type: Primary
published: '2024-04-17T11:15:10.113'
references:
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/0971126c8164abe2004b8536b49690a0d6005b0a
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/15641007df0f0d35fa28742b25c2a7db9dcd6895
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/21e5fa4688e1a4d3db6b72216231b24232f75c1d
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/43f798b9036491fb014b55dd61c4c5c3193267d0
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/7070b274c7866a4c5036f8d54fcaf315c64ac33a
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/7a4b21250bf79eef26543d35bd390448646c536b
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/ca1f06e72dec41ae4f76e7b1a8a97265447b46ae
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/d0e214acc59145ce25113f617311aa79dda39cb3
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/f06899582ccee09bd85d0696290e3eaca9aa042d
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://lists.debian.org/debian-lts-announce/2024/06/msg00017.html
sourceIdentifier: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
vulnStatus: Modified
weaknesses:
- description:
  - lang: en
    value: CWE-119
  source: nvd@nist.gov
  type: Primary
