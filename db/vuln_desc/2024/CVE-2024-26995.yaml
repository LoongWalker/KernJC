descriptions:
- lang: en
  value: 'In the Linux kernel, the following vulnerability has been resolved:


    usb: typec: tcpm: Correct the PDO counting in pd_set


    Off-by-one errors happen because nr_snk_pdo and nr_src_pdo are

    incorrectly added one. The index of the loop is equal to the number of

    PDOs to be updated when leaving the loop and it doesn''t need to be added

    one.


    When doing the power negotiation, TCPM relies on the "nr_snk_pdo" as

    the size of the local sink PDO array to match the Source capabilities

    of the partner port. If the off-by-one overflow occurs, a wrong RDO

    might be sent and unexpected power transfer might happen such as over

    voltage or over current (than expected).


    "nr_src_pdo" is used to set the Rp level when the port is in Source

    role. It is also the array size of the local Source capabilities when

    filling up the buffer which will be sent as the Source PDOs (such as

    in Power Negotiation). If the off-by-one overflow occurs, a wrong Rp

    level might be set and wrong Source PDOs will be sent to the partner

    port. This could potentially cause over current or port resets.'
- lang: es
  value: "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: usb:\
    \ typec: tcpm: corrija el recuento de PDO en pd_set Los errores off-by-one ocurren\
    \ porque nr_snk_pdo y nr_src_pdo se agregaron incorrectamente. El \xEDndice del\
    \ bucle es igual al n\xFAmero de PDO que se actualizar\xE1n al salir del bucle\
    \ y no es necesario agregar uno. Al realizar la negociaci\xF3n de energ\xEDa,\
    \ TCPM se basa en \"nr_snk_pdo\" como el tama\xF1o de la matriz de PDO del receptor\
    \ local para que coincida con las capacidades de origen del puerto asociado. Si\
    \ se produce un desbordamiento de uno a uno, es posible que se env\xEDe un RDO\
    \ incorrecto y que se produzca una transferencia de energ\xEDa inesperada, como\
    \ sobretensi\xF3n o sobrecorriente (de lo esperado). \"nr_src_pdo\" se utiliza\
    \ para establecer el nivel de Rp cuando el puerto est\xE1 en la funci\xF3n de\
    \ origen. Tambi\xE9n es el tama\xF1o de la matriz de las capacidades de la Fuente\
    \ local al llenar el b\xFAfer que se enviar\xE1 como los PDO de la Fuente (como\
    \ en la Negociaci\xF3n de Energ\xEDa). Si se produce el desbordamiento de uno\
    \ por uno, es posible que se establezca un nivel de Rp incorrecto y se enviar\xE1\
    n PDO de origen incorrectos al puerto asociado. Esto podr\xEDa causar sobrecorriente\
    \ o restablecimientos de puertos."
id: CVE-2024-26995
lastModified: '2024-05-13T08:15:11.270'
metrics: {}
published: '2024-05-01T06:15:17.313'
references:
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/c4128304c2169b4664ed6fb6200f228cead2ab70
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/f3da3192cdd3fefe213390e976eec424a8e270b5
sourceIdentifier: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
vulnStatus: Awaiting Analysis
